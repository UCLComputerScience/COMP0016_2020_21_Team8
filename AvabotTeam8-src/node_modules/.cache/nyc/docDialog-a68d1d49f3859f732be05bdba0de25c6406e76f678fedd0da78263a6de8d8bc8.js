function cov_1boptpdvjn(){var path="/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/docDialog.js";var hash="c62846567d86716247b6d2121a6dcf497e1c4b81";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/docDialog.js",statementMap:{"0":{start:{line:4,column:13},end:{line:4,column:28}},"1":{start:{line:5,column:14},end:{line:5,column:30}},"2":{start:{line:6,column:12},end:{line:6,column:31}},"3":{start:{line:7,column:15},end:{line:7,column:35}},"4":{start:{line:8,column:86},end:{line:8,column:115}},"5":{start:{line:9,column:19},end:{line:9,column:31}},"6":{start:{line:10,column:25},end:{line:10,column:43}},"7":{start:{line:11,column:20},end:{line:11,column:33}},"8":{start:{line:12,column:22},end:{line:12,column:37}},"9":{start:{line:17,column:8},end:{line:17,column:26}},"10":{start:{line:18,column:8},end:{line:18,column:29}},"11":{start:{line:19,column:8},end:{line:19,column:22}},"12":{start:{line:20,column:8},end:{line:20,column:23}},"13":{start:{line:21,column:8},end:{line:21,column:24}},"14":{start:{line:22,column:8},end:{line:22,column:27}},"15":{start:{line:24,column:8},end:{line:24,column:52}},"16":{start:{line:25,column:8},end:{line:25,column:56}},"17":{start:{line:26,column:8},end:{line:30,column:12}},"18":{start:{line:32,column:8},end:{line:32,column:48}},"19":{start:{line:36,column:8},end:{line:50,column:9}},"20":{start:{line:37,column:12},end:{line:40,column:15}},"21":{start:{line:43,column:12},end:{line:43,column:78}},"22":{start:{line:44,column:12},end:{line:44,column:84}},"23":{start:{line:45,column:12},end:{line:45,column:93}},"24":{start:{line:46,column:12},end:{line:49,column:15}},"25":{start:{line:54,column:8},end:{line:54,column:39}},"26":{start:{line:55,column:23},end:{line:55,column:40}},"27":{start:{line:56,column:8},end:{line:79,column:9}},"28":{start:{line:57,column:12},end:{line:62,column:13}},"29":{start:{line:58,column:16},end:{line:58,column:58}},"30":{start:{line:61,column:16},end:{line:61,column:73}},"31":{start:{line:65,column:13},end:{line:79,column:9}},"32":{start:{line:66,column:12},end:{line:66,column:80}},"33":{start:{line:68,column:13},end:{line:79,column:9}},"34":{start:{line:69,column:12},end:{line:74,column:13}},"35":{start:{line:70,column:16},end:{line:70,column:91}},"36":{start:{line:73,column:16},end:{line:73,column:83}},"37":{start:{line:78,column:12},end:{line:78,column:42}},"38":{start:{line:81,column:8},end:{line:81,column:109}},"39":{start:{line:93,column:8},end:{line:93,column:76}},"40":{start:{line:94,column:8},end:{line:94,column:109}},"41":{start:{line:114,column:0},end:{line:114,column:37}},"42":{start:{line:115,column:0},end:{line:115,column:39}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:4},end:{line:16,column:5}},loc:{start:{line:16,column:24},end:{line:33,column:5}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:35,column:4},end:{line:35,column:5}},loc:{start:{line:35,column:33},end:{line:51,column:5}},line:35},"2":{name:"(anonymous_2)",decl:{start:{line:53,column:4},end:{line:53,column:5}},loc:{start:{line:53,column:25},end:{line:82,column:5}},line:53},"3":{name:"(anonymous_3)",decl:{start:{line:84,column:4},end:{line:84,column:5}},loc:{start:{line:84,column:27},end:{line:95,column:5}},line:84}},branchMap:{"0":{loc:{start:{line:36,column:8},end:{line:50,column:9}},type:"if",locations:[{start:{line:36,column:8},end:{line:50,column:9}},{start:{line:36,column:8},end:{line:50,column:9}}],line:36},"1":{loc:{start:{line:43,column:23},end:{line:43,column:77}},type:"cond-expr",locations:[{start:{line:43,column:49},end:{line:43,column:72}},{start:{line:43,column:75},end:{line:43,column:77}}],line:43},"2":{loc:{start:{line:44,column:25},end:{line:44,column:83}},type:"cond-expr",locations:[{start:{line:44,column:53},end:{line:44,column:78}},{start:{line:44,column:81},end:{line:44,column:83}}],line:44},"3":{loc:{start:{line:45,column:28},end:{line:45,column:92}},type:"cond-expr",locations:[{start:{line:45,column:59},end:{line:45,column:87}},{start:{line:45,column:90},end:{line:45,column:92}}],line:45},"4":{loc:{start:{line:56,column:8},end:{line:79,column:9}},type:"if",locations:[{start:{line:56,column:8},end:{line:79,column:9}},{start:{line:56,column:8},end:{line:79,column:9}}],line:56},"5":{loc:{start:{line:57,column:12},end:{line:62,column:13}},type:"if",locations:[{start:{line:57,column:12},end:{line:62,column:13}},{start:{line:57,column:12},end:{line:62,column:13}}],line:57},"6":{loc:{start:{line:65,column:13},end:{line:79,column:9}},type:"if",locations:[{start:{line:65,column:13},end:{line:79,column:9}},{start:{line:65,column:13},end:{line:79,column:9}}],line:65},"7":{loc:{start:{line:68,column:13},end:{line:79,column:9}},type:"if",locations:[{start:{line:68,column:13},end:{line:79,column:9}},{start:{line:68,column:13},end:{line:79,column:9}}],line:68},"8":{loc:{start:{line:69,column:12},end:{line:74,column:13}},type:"if",locations:[{start:{line:69,column:12},end:{line:74,column:13}},{start:{line:69,column:12},end:{line:74,column:13}}],line:69}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c62846567d86716247b6d2121a6dcf497e1c4b81"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1boptpdvjn=function(){return actualCoverage;};}return actualCoverage;}cov_1boptpdvjn();// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
const path=(cov_1boptpdvjn().s[0]++,require('path'));const axios=(cov_1boptpdvjn().s[1]++,require('axios'));const fse=(cov_1boptpdvjn().s[2]++,require("fs-extra"));var FormData=(cov_1boptpdvjn().s[3]++,require("form-data"));const{ComponentDialog,ChoiceFactory,ChoicePrompt,TextPrompt,WaterfallDialog}=(cov_1boptpdvjn().s[4]++,require('botbuilder-dialogs'));const DOC_DIALOG=(cov_1boptpdvjn().s[5]++,'DOC_DIALOG');const WATERFALL_DIALOG=(cov_1boptpdvjn().s[6]++,'WATERFALL_DIALOG');const TEXT_PROMPT=(cov_1boptpdvjn().s[7]++,'TEXT_PROMPT');const CHOICE_PROMPT=(cov_1boptpdvjn().s[8]++,'CHOICE_PROMPT');class DocDialog extends ComponentDialog{constructor(mainId){cov_1boptpdvjn().f[0]++;cov_1boptpdvjn().s[9]++;super(DOC_DIALOG);cov_1boptpdvjn().s[10]++;this.mainId=mainId;cov_1boptpdvjn().s[11]++;this.sum='';cov_1boptpdvjn().s[12]++;this.form='';cov_1boptpdvjn().s[13]++;this.query='';cov_1boptpdvjn().s[14]++;this.filepath='';cov_1boptpdvjn().s[15]++;this.addDialog(new TextPrompt(TEXT_PROMPT));cov_1boptpdvjn().s[16]++;this.addDialog(new ChoicePrompt(CHOICE_PROMPT));cov_1boptpdvjn().s[17]++;this.addDialog(new WaterfallDialog(WATERFALL_DIALOG,[this.beginStep.bind(this),this.dealStep.bind(this),this.answerStep.bind(this)]));cov_1boptpdvjn().s[18]++;this.initialDialogId=WATERFALL_DIALOG;}async beginStep(stepContext){cov_1boptpdvjn().f[1]++;cov_1boptpdvjn().s[19]++;if(stepContext.options.restartMsg){cov_1boptpdvjn().b[0][0]++;cov_1boptpdvjn().s[20]++;return await stepContext.prompt(CHOICE_PROMPT,{prompt:'Anything else for the document?',choices:ChoiceFactory.toChoices(['summarize it','extract form','ask me about it','no'])});}else{cov_1boptpdvjn().b[0][1]++;cov_1boptpdvjn().s[21]++;this.sum=stepContext.options.sum?(cov_1boptpdvjn().b[1][0]++,stepContext.options.sum):(cov_1boptpdvjn().b[1][1]++,'');cov_1boptpdvjn().s[22]++;this.query=stepContext.options.query?(cov_1boptpdvjn().b[2][0]++,stepContext.options.query):(cov_1boptpdvjn().b[2][1]++,'');cov_1boptpdvjn().s[23]++;this.filepath=stepContext.options.filepath?(cov_1boptpdvjn().b[3][0]++,stepContext.options.filepath):(cov_1boptpdvjn().b[3][1]++,'');cov_1boptpdvjn().s[24]++;return await stepContext.prompt(CHOICE_PROMPT,{prompt:'How can I help with the document?',choices:ChoiceFactory.toChoices(['summarize it','extract form','ask me about it'])});}}async dealStep(step){cov_1boptpdvjn().f[2]++;cov_1boptpdvjn().s[25]++;console.log(step.result.value);const choice=(cov_1boptpdvjn().s[26]++,step.result.value);cov_1boptpdvjn().s[27]++;if(choice=='summarize it'){cov_1boptpdvjn().b[4][0]++;cov_1boptpdvjn().s[28]++;if(this.sum){cov_1boptpdvjn().b[5][0]++;cov_1boptpdvjn().s[29]++;await step.context.sendActivity(this.sum);}else{cov_1boptpdvjn().b[5][1]++;cov_1boptpdvjn().s[30]++;await step.context.sendActivity('Summarization failed.');}}else{cov_1boptpdvjn().b[4][1]++;cov_1boptpdvjn().s[31]++;if(choice=='extract form'){cov_1boptpdvjn().b[6][0]++;cov_1boptpdvjn().s[32]++;await step.context.sendActivity('More functions to be updating...');}else{cov_1boptpdvjn().b[6][1]++;cov_1boptpdvjn().s[33]++;if(choice=='ask me about it'){cov_1boptpdvjn().b[7][0]++;cov_1boptpdvjn().s[34]++;if(this.query){cov_1boptpdvjn().b[8][0]++;cov_1boptpdvjn().s[35]++;return await step.prompt(TEXT_PROMPT,{prompt:'What is the question?'});}else{cov_1boptpdvjn().b[8][1]++;cov_1boptpdvjn().s[36]++;await step.context.sendActivity('QA system preprocessing failed.');}}else{cov_1boptpdvjn().b[7][1]++;cov_1boptpdvjn().s[37]++;return await step.endDialog();}}}cov_1boptpdvjn().s[38]++;return await step.replaceDialog(this.initialDialogId,{restartMsg:'What else can I do for you?'});}async answerStep(step){cov_1boptpdvjn().f[3]++;cov_1boptpdvjn().s[39]++;// var question = step.result;
// console.log('question: ' + question);
// let answer = await axios.get('http://51.11.38.199:5000?query="'+question)
// .then(v => v.data)
// .catch(function (error) {
//     console.log(error);
// });
// await step.context.sendActivity(answer);
await step.context.sendActivity('More functions to be updating...');cov_1boptpdvjn().s[40]++;return await step.replaceDialog(this.initialDialogId,{restartMsg:'What else can I do for you?'});}// async sumText(step) {
//     var form = new FormData();
//     const FileName = path.join(__dirname, 'text.pdf');
//     form.append("file", fse.createReadStream(FileName));
//     let r = await axios({
//         method: "post",
//         url: "https://textsumapi.azurewebsites.net/api/textsumapi",
//         data: form,
//         headers: form.getHeaders()
//     }).then(v => v.data);
//     console.log(r); // ok
//     await step.context.sendActivity(r);
// }
}cov_1boptpdvjn().s[41]++;module.exports.DocDialog=DocDialog;cov_1boptpdvjn().s[42]++;module.exports.DOC_DIALOG=DOC_DIALOG;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRvY0RpYWxvZy5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImF4aW9zIiwiZnNlIiwiRm9ybURhdGEiLCJDb21wb25lbnREaWFsb2ciLCJDaG9pY2VGYWN0b3J5IiwiQ2hvaWNlUHJvbXB0IiwiVGV4dFByb21wdCIsIldhdGVyZmFsbERpYWxvZyIsIkRPQ19ESUFMT0ciLCJXQVRFUkZBTExfRElBTE9HIiwiVEVYVF9QUk9NUFQiLCJDSE9JQ0VfUFJPTVBUIiwiRG9jRGlhbG9nIiwiY29uc3RydWN0b3IiLCJtYWluSWQiLCJzdW0iLCJmb3JtIiwicXVlcnkiLCJmaWxlcGF0aCIsImFkZERpYWxvZyIsImJlZ2luU3RlcCIsImJpbmQiLCJkZWFsU3RlcCIsImFuc3dlclN0ZXAiLCJpbml0aWFsRGlhbG9nSWQiLCJzdGVwQ29udGV4dCIsIm9wdGlvbnMiLCJyZXN0YXJ0TXNnIiwicHJvbXB0IiwiY2hvaWNlcyIsInRvQ2hvaWNlcyIsInN0ZXAiLCJjb25zb2xlIiwibG9nIiwicmVzdWx0IiwidmFsdWUiLCJjaG9pY2UiLCJjb250ZXh0Iiwic2VuZEFjdGl2aXR5IiwiZW5kRGlhbG9nIiwicmVwbGFjZURpYWxvZyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiIwcUxBZVk7MkZBZlo7QUFDQTtBQUVBLEtBQU1BLENBQUFBLElBQUksMEJBQUdDLE9BQU8sQ0FBQyxNQUFELENBQVYsQ0FBVixDQUNBLEtBQU1DLENBQUFBLEtBQUssMEJBQUdELE9BQU8sQ0FBQyxPQUFELENBQVYsQ0FBWCxDQUNBLEtBQU1FLENBQUFBLEdBQUcsMEJBQUdGLE9BQU8sQ0FBQyxVQUFELENBQVYsQ0FBVCxDQUNBLEdBQUlHLENBQUFBLFFBQVEsMEJBQUdILE9BQU8sQ0FBQyxXQUFELENBQVYsQ0FBWixDQUNBLEtBQU0sQ0FBRUksZUFBRixDQUFtQkMsYUFBbkIsQ0FBa0NDLFlBQWxDLENBQWdEQyxVQUFoRCxDQUE0REMsZUFBNUQsMkJBQWdGUixPQUFPLENBQUMs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Q0FBTixDQVRtQix5QkFVbkIsTUFBTyxNQUFNUCxDQUFBQSxJQUFJLENBQUNTLGFBQUwsQ0FBbUIsS0FBS2hCLGVBQXhCLENBQXlDLENBQUVHLFVBQVUsQ0FBRSw2QkFBZCxDQUF6QyxDQUFiLENBQ0gsQ0FFRDtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQWhHb0MsQyx5QkFtR3hDYyxNQUFNLENBQUNDLE9BQVAsQ0FBZTlCLFNBQWYsQ0FBMkJBLFNBQTNCLEMseUJBQ0E2QixNQUFNLENBQUNDLE9BQVAsQ0FBZWxDLFVBQWYsQ0FBNEJBLFVBQTVCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuXHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcbmNvbnN0IGF4aW9zID0gcmVxdWlyZSgnYXhpb3MnKTtcclxuY29uc3QgZnNlID0gcmVxdWlyZShcImZzLWV4dHJhXCIpO1xyXG52YXIgRm9ybURhdGEgPSByZXF1aXJlKFwiZm9ybS1kYXRhXCIpO1xyXG5jb25zdCB7IENvbXBvbmVudERpYWxvZywgQ2hvaWNlRmFjdG9yeSwgQ2hvaWNlUHJvbXB0LCBUZXh0UHJvbXB0LCBXYXRlcmZhbGxEaWFsb2cgfSA9IHJlcXVpcmUoJ2JvdGJ1aWxkZXItZGlhbG9ncycpO1xyXG5jb25zdCBET0NfRElBTE9HID0gJ0RPQ19ESUFMT0cnO1xyXG5jb25zdCBXQVRFUkZBTExfRElBTE9HID0gJ1dBVEVSRkFMTF9ESUFMT0cnO1xyXG5jb25zdCBURVhUX1BST01QVCA9ICdURVhUX1BST01QVCc7XHJcbmNvbnN0IENIT0lDRV9QUk9NUFQgPSAnQ0hPSUNFX1BST01QVCc7XHJcblxyXG5cclxuY2xhc3MgRG9jRGlhbG9nIGV4dGVuZHMgQ29tcG9uZW50RGlhbG9nIHtcclxuICAgIGNvbnN0cnVjdG9yKG1haW5JZCkge1xyXG4gICAgICAgIHN1cGVyKERPQ19ESUFMT0cpO1xyXG4gICAgICAgIHRoaXMubWFpbklkID0gbWFpbklkO1xyXG4gICAgICAgIHRoaXMuc3VtID0gJyc7XHJcbiAgICAgICAgdGhpcy5mb3JtID0gJyc7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9ICcnO1xyXG4gICAgICAgIHRoaXMuZmlsZXBhdGggPSAnJztcclxuXHJcbiAgICAgICAgdGhpcy5hZGREaWFsb2cobmV3IFRleHRQcm9tcHQoVEVYVF9QUk9NUFQpKTtcclxuICAgICAgICB0aGlzLmFkZERpYWxvZyhuZXcgQ2hvaWNlUHJvbXB0KENIT0lDRV9QUk9NUFQpKTtcclxuICAgICAgICB0aGlzLmFkZERpYWxvZyhuZXcgV2F0ZXJmYWxsRGlhbG9nKFdBVEVSRkFMTF9ESUFMT0csIFtcclxuICAgICAgICAgICAgdGhpcy5iZWdpblN0ZXAuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgdGhpcy5kZWFsU3RlcC5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICB0aGlzLmFuc3dlclN0ZXAuYmluZCh0aGlzKVxyXG4gICAgICAgIF0pKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0aWFsRGlhbG9nSWQgPSBXQVRFUkZBTExfRElBTE9HO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGJlZ2luU3RlcChzdGVwQ29udGV4dCkge1xyXG4gICAgICAgIGlmIChzdGVwQ29udGV4dC5vcHRpb25zLnJlc3RhcnRNc2cpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHN0ZXBDb250ZXh0LnByb21wdChDSE9JQ0VfUFJPTVBULCB7XHJcbiAgICAgICAgICAgICAgICBwcm9tcHQ6ICdBbnl0aGluZyBlbHNlIGZvciB0aGUgZG9jdW1lbnQ/JyxcclxuICAgICAgICAgICAgICAgIGNob2ljZXM6IENob2ljZUZhY3RvcnkudG9DaG9pY2VzKFsnc3VtbWFyaXplIGl0JywgJ2V4dHJhY3QgZm9ybScsICdhc2sgbWUgYWJvdXQgaXQnLCAnbm8nXSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnN1bSA9IHN0ZXBDb250ZXh0Lm9wdGlvbnMuc3VtID8gc3RlcENvbnRleHQub3B0aW9ucy5zdW0gOiAnJztcclxuICAgICAgICAgICAgdGhpcy5xdWVyeSA9IHN0ZXBDb250ZXh0Lm9wdGlvbnMucXVlcnkgPyBzdGVwQ29udGV4dC5vcHRpb25zLnF1ZXJ5IDogJyc7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsZXBhdGggPSBzdGVwQ29udGV4dC5vcHRpb25zLmZpbGVwYXRoID8gc3RlcENvbnRleHQub3B0aW9ucy5maWxlcGF0aCA6ICcnO1xyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgc3RlcENvbnRleHQucHJvbXB0KENIT0lDRV9QUk9NUFQsIHtcclxuICAgICAgICAgICAgICAgIHByb21wdDogJ0hvdyBjYW4gSSBoZWxwIHdpdGggdGhlIGRvY3VtZW50PycsXHJcbiAgICAgICAgICAgICAgICBjaG9pY2VzOiBDaG9pY2VGYWN0b3J5LnRvQ2hvaWNlcyhbJ3N1bW1hcml6ZSBpdCcsICdleHRyYWN0IGZvcm0nLCAnYXNrIG1lIGFib3V0IGl0J10pXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBkZWFsU3RlcChzdGVwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coc3RlcC5yZXN1bHQudmFsdWUpO1xyXG4gICAgICAgIGNvbnN0IGNob2ljZSA9IHN0ZXAucmVzdWx0LnZhbHVlO1xyXG4gICAgICAgIGlmIChjaG9pY2UgPT0gJ3N1bW1hcml6ZSBpdCcpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3VtKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KHRoaXMuc3VtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHN0ZXAuY29udGV4dC5zZW5kQWN0aXZpdHkoJ1N1bW1hcml6YXRpb24gZmFpbGVkLicpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaG9pY2UgPT0gJ2V4dHJhY3QgZm9ybScpIHtcclxuICAgICAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eSgnTW9yZSBmdW5jdGlvbnMgdG8gYmUgdXBkYXRpbmcuLi4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hvaWNlID09ICdhc2sgbWUgYWJvdXQgaXQnKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgc3RlcC5wcm9tcHQoVEVYVF9QUk9NUFQsIHsgcHJvbXB0OiAnV2hhdCBpcyB0aGUgcXVlc3Rpb24/JyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHN0ZXAuY29udGV4dC5zZW5kQWN0aXZpdHkoJ1FBIHN5c3RlbSBwcmVwcm9jZXNzaW5nIGZhaWxlZC4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBzdGVwLmVuZERpYWxvZygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHN0ZXAucmVwbGFjZURpYWxvZyh0aGlzLmluaXRpYWxEaWFsb2dJZCwgeyByZXN0YXJ0TXNnOiAnV2hhdCBlbHNlIGNhbiBJIGRvIGZvciB5b3U/JyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBhbnN3ZXJTdGVwKHN0ZXApIHtcclxuICAgICAgICAvLyB2YXIgcXVlc3Rpb24gPSBzdGVwLnJlc3VsdDtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygncXVlc3Rpb246ICcgKyBxdWVzdGlvbik7XHJcbiAgICAgICAgLy8gbGV0IGFuc3dlciA9IGF3YWl0IGF4aW9zLmdldCgnaHR0cDovLzUxLjExLjM4LjE5OTo1MDAwP3F1ZXJ5PVwiJytxdWVzdGlvbilcclxuICAgICAgICAvLyAudGhlbih2ID0+IHYuZGF0YSlcclxuICAgICAgICAvLyAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAvLyB9KTtcclxuICAgICAgICAvLyBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KGFuc3dlcik7XHJcbiAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eSgnTW9yZSBmdW5jdGlvbnMgdG8gYmUgdXBkYXRpbmcuLi4nKTtcclxuICAgICAgICByZXR1cm4gYXdhaXQgc3RlcC5yZXBsYWNlRGlhbG9nKHRoaXMuaW5pdGlhbERpYWxvZ0lkLCB7IHJlc3RhcnRNc2c6ICdXaGF0IGVsc2UgY2FuIEkgZG8gZm9yIHlvdT8nIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGFzeW5jIHN1bVRleHQoc3RlcCkge1xyXG4gICAgLy8gICAgIHZhciBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAvLyAgICAgY29uc3QgRmlsZU5hbWUgPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAndGV4dC5wZGYnKTtcclxuICAgIC8vICAgICBmb3JtLmFwcGVuZChcImZpbGVcIiwgZnNlLmNyZWF0ZVJlYWRTdHJlYW0oRmlsZU5hbWUpKTtcclxuXHJcbiAgICAvLyAgICAgbGV0IHIgPSBhd2FpdCBheGlvcyh7XHJcbiAgICAvLyAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAvLyAgICAgICAgIHVybDogXCJodHRwczovL3RleHRzdW1hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL3RleHRzdW1hcGlcIixcclxuICAgIC8vICAgICAgICAgZGF0YTogZm9ybSxcclxuICAgIC8vICAgICAgICAgaGVhZGVyczogZm9ybS5nZXRIZWFkZXJzKClcclxuICAgIC8vICAgICB9KS50aGVuKHYgPT4gdi5kYXRhKTtcclxuXHJcbiAgICAvLyAgICAgY29uc29sZS5sb2cocik7IC8vIG9rXHJcbiAgICAvLyAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eShyKTtcclxuICAgIC8vIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMuRG9jRGlhbG9nID0gRG9jRGlhbG9nO1xyXG5tb2R1bGUuZXhwb3J0cy5ET0NfRElBTE9HID0gRE9DX0RJQUxPRzsiXX0=