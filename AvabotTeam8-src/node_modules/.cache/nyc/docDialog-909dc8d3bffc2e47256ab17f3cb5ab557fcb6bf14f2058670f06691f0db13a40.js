function cov_1boptpdvjn(){var path="/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/docDialog.js";var hash="4b577f3f73bc138cfe1fa1d594916ac38774fac8";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/docDialog.js",statementMap:{"0":{start:{line:4,column:86},end:{line:4,column:115}},"1":{start:{line:5,column:19},end:{line:5,column:31}},"2":{start:{line:6,column:25},end:{line:6,column:43}},"3":{start:{line:7,column:20},end:{line:7,column:33}},"4":{start:{line:8,column:22},end:{line:8,column:37}},"5":{start:{line:13,column:8},end:{line:13,column:26}},"6":{start:{line:14,column:8},end:{line:14,column:29}},"7":{start:{line:15,column:8},end:{line:15,column:22}},"8":{start:{line:16,column:8},end:{line:16,column:23}},"9":{start:{line:17,column:8},end:{line:17,column:24}},"10":{start:{line:18,column:8},end:{line:18,column:27}},"11":{start:{line:20,column:8},end:{line:20,column:52}},"12":{start:{line:21,column:8},end:{line:21,column:56}},"13":{start:{line:22,column:8},end:{line:26,column:12}},"14":{start:{line:28,column:8},end:{line:28,column:48}},"15":{start:{line:32,column:8},end:{line:47,column:9}},"16":{start:{line:33,column:12},end:{line:36,column:15}},"17":{start:{line:39,column:12},end:{line:39,column:84}},"18":{start:{line:40,column:12},end:{line:40,column:92}},"19":{start:{line:41,column:12},end:{line:41,column:88}},"20":{start:{line:42,column:12},end:{line:42,column:104}},"21":{start:{line:43,column:12},end:{line:46,column:15}},"22":{start:{line:51,column:8},end:{line:51,column:39}},"23":{start:{line:52,column:23},end:{line:52,column:40}},"24":{start:{line:53,column:8},end:{line:81,column:9}},"25":{start:{line:54,column:12},end:{line:59,column:13}},"26":{start:{line:55,column:16},end:{line:55,column:58}},"27":{start:{line:58,column:16},end:{line:58,column:73}},"28":{start:{line:62,column:13},end:{line:81,column:9}},"29":{start:{line:63,column:12},end:{line:68,column:13}},"30":{start:{line:64,column:16},end:{line:64,column:59}},"31":{start:{line:67,column:16},end:{line:67,column:76}},"32":{start:{line:70,column:13},end:{line:81,column:9}},"33":{start:{line:71,column:12},end:{line:76,column:13}},"34":{start:{line:72,column:16},end:{line:72,column:91}},"35":{start:{line:75,column:16},end:{line:75,column:83}},"36":{start:{line:80,column:12},end:{line:80,column:42}},"37":{start:{line:83,column:8},end:{line:83,column:109}},"38":{start:{line:95,column:8},end:{line:95,column:76}},"39":{start:{line:96,column:8},end:{line:96,column:109}},"40":{start:{line:115,column:8},end:{line:115,column:21}},"41":{start:{line:118,column:8},end:{line:118,column:23}},"42":{start:{line:121,column:8},end:{line:121,column:22}},"43":{start:{line:125,column:0},end:{line:125,column:37}},"44":{start:{line:126,column:0},end:{line:126,column:39}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:4},end:{line:12,column:5}},loc:{start:{line:12,column:24},end:{line:29,column:5}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:31,column:4},end:{line:31,column:5}},loc:{start:{line:31,column:33},end:{line:48,column:5}},line:31},"2":{name:"(anonymous_2)",decl:{start:{line:50,column:4},end:{line:50,column:5}},loc:{start:{line:50,column:25},end:{line:84,column:5}},line:50},"3":{name:"(anonymous_3)",decl:{start:{line:86,column:4},end:{line:86,column:5}},loc:{start:{line:86,column:27},end:{line:97,column:5}},line:86},"4":{name:"(anonymous_4)",decl:{start:{line:114,column:4},end:{line:114,column:5}},loc:{start:{line:114,column:12},end:{line:116,column:5}},line:114},"5":{name:"(anonymous_5)",decl:{start:{line:117,column:4},end:{line:117,column:5}},loc:{start:{line:117,column:12},end:{line:119,column:5}},line:117},"6":{name:"(anonymous_6)",decl:{start:{line:120,column:4},end:{line:120,column:5}},loc:{start:{line:120,column:12},end:{line:122,column:5}},line:120}},branchMap:{"0":{loc:{start:{line:32,column:8},end:{line:47,column:9}},type:"if",locations:[{start:{line:32,column:8},end:{line:47,column:9}},{start:{line:32,column:8},end:{line:47,column:9}}],line:32},"1":{loc:{start:{line:39,column:23},end:{line:39,column:83}},type:"cond-expr",locations:[{start:{line:39,column:49},end:{line:39,column:72}},{start:{line:39,column:75},end:{line:39,column:83}}],line:39},"2":{loc:{start:{line:40,column:25},end:{line:40,column:91}},type:"cond-expr",locations:[{start:{line:40,column:53},end:{line:40,column:78}},{start:{line:40,column:81},end:{line:40,column:91}}],line:40},"3":{loc:{start:{line:41,column:24},end:{line:41,column:87}},type:"cond-expr",locations:[{start:{line:41,column:51},end:{line:41,column:75}},{start:{line:41,column:78},end:{line:41,column:87}}],line:41},"4":{loc:{start:{line:42,column:28},end:{line:42,column:103}},type:"cond-expr",locations:[{start:{line:42,column:59},end:{line:42,column:87}},{start:{line:42,column:90},end:{line:42,column:103}}],line:42},"5":{loc:{start:{line:53,column:8},end:{line:81,column:9}},type:"if",locations:[{start:{line:53,column:8},end:{line:81,column:9}},{start:{line:53,column:8},end:{line:81,column:9}}],line:53},"6":{loc:{start:{line:54,column:12},end:{line:59,column:13}},type:"if",locations:[{start:{line:54,column:12},end:{line:59,column:13}},{start:{line:54,column:12},end:{line:59,column:13}}],line:54},"7":{loc:{start:{line:62,column:13},end:{line:81,column:9}},type:"if",locations:[{start:{line:62,column:13},end:{line:81,column:9}},{start:{line:62,column:13},end:{line:81,column:9}}],line:62},"8":{loc:{start:{line:63,column:12},end:{line:68,column:13}},type:"if",locations:[{start:{line:63,column:12},end:{line:68,column:13}},{start:{line:63,column:12},end:{line:68,column:13}}],line:63},"9":{loc:{start:{line:70,column:13},end:{line:81,column:9}},type:"if",locations:[{start:{line:70,column:13},end:{line:81,column:9}},{start:{line:70,column:13},end:{line:81,column:9}}],line:70},"10":{loc:{start:{line:71,column:12},end:{line:76,column:13}},type:"if",locations:[{start:{line:71,column:12},end:{line:76,column:13}},{start:{line:71,column:12},end:{line:76,column:13}}],line:71}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"4b577f3f73bc138cfe1fa1d594916ac38774fac8"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1boptpdvjn=function(){return actualCoverage;};}return actualCoverage;}cov_1boptpdvjn();// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
const{ComponentDialog,ChoiceFactory,ChoicePrompt,TextPrompt,WaterfallDialog}=(cov_1boptpdvjn().s[0]++,require('botbuilder-dialogs'));const DOC_DIALOG=(cov_1boptpdvjn().s[1]++,'DOC_DIALOG');const WATERFALL_DIALOG=(cov_1boptpdvjn().s[2]++,'WATERFALL_DIALOG');const TEXT_PROMPT=(cov_1boptpdvjn().s[3]++,'TEXT_PROMPT');const CHOICE_PROMPT=(cov_1boptpdvjn().s[4]++,'CHOICE_PROMPT');class DocDialog extends ComponentDialog{constructor(mainId){cov_1boptpdvjn().f[0]++;cov_1boptpdvjn().s[5]++;super(DOC_DIALOG);cov_1boptpdvjn().s[6]++;this.mainId=mainId;cov_1boptpdvjn().s[7]++;this.sum='';cov_1boptpdvjn().s[8]++;this.form='';cov_1boptpdvjn().s[9]++;this.query='';cov_1boptpdvjn().s[10]++;this.filepath='';cov_1boptpdvjn().s[11]++;this.addDialog(new TextPrompt(TEXT_PROMPT));cov_1boptpdvjn().s[12]++;this.addDialog(new ChoicePrompt(CHOICE_PROMPT));cov_1boptpdvjn().s[13]++;this.addDialog(new WaterfallDialog(WATERFALL_DIALOG,[this.beginStep.bind(this),this.dealStep.bind(this),this.answerStep.bind(this)]));cov_1boptpdvjn().s[14]++;this.initialDialogId=WATERFALL_DIALOG;}async beginStep(stepContext){cov_1boptpdvjn().f[1]++;cov_1boptpdvjn().s[15]++;if(stepContext.options.restartMsg){cov_1boptpdvjn().b[0][0]++;cov_1boptpdvjn().s[16]++;return await stepContext.prompt(CHOICE_PROMPT,{prompt:'Anything else for the document?',choices:ChoiceFactory.toChoices(['summarize it','extract table','QnA about it','no'])});}else{cov_1boptpdvjn().b[0][1]++;cov_1boptpdvjn().s[17]++;this.sum=stepContext.options.sum?(cov_1boptpdvjn().b[1][0]++,stepContext.options.sum):(cov_1boptpdvjn().b[1][1]++,this.sum);cov_1boptpdvjn().s[18]++;this.query=stepContext.options.query?(cov_1boptpdvjn().b[2][0]++,stepContext.options.query):(cov_1boptpdvjn().b[2][1]++,this.query);cov_1boptpdvjn().s[19]++;this.form=stepContext.options.form?(cov_1boptpdvjn().b[3][0]++,stepContext.options.form):(cov_1boptpdvjn().b[3][1]++,this.form);cov_1boptpdvjn().s[20]++;this.filepath=stepContext.options.filepath?(cov_1boptpdvjn().b[4][0]++,stepContext.options.filepath):(cov_1boptpdvjn().b[4][1]++,this.filepath);cov_1boptpdvjn().s[21]++;return await stepContext.prompt(CHOICE_PROMPT,{prompt:'How can I help with the document?',choices:ChoiceFactory.toChoices(['summarize it','extract table','QnA about it'])});}}async dealStep(step){cov_1boptpdvjn().f[2]++;cov_1boptpdvjn().s[22]++;console.log(step.result.value);const choice=(cov_1boptpdvjn().s[23]++,step.result.value);cov_1boptpdvjn().s[24]++;if(choice=='summarize it'){cov_1boptpdvjn().b[5][0]++;cov_1boptpdvjn().s[25]++;if(this.sum){cov_1boptpdvjn().b[6][0]++;cov_1boptpdvjn().s[26]++;await step.context.sendActivity(this.sum);}else{cov_1boptpdvjn().b[6][1]++;cov_1boptpdvjn().s[27]++;await step.context.sendActivity('Summarization failed.');}}else{cov_1boptpdvjn().b[5][1]++;cov_1boptpdvjn().s[28]++;if(choice=='extract table'){cov_1boptpdvjn().b[7][0]++;cov_1boptpdvjn().s[29]++;if(this.form){cov_1boptpdvjn().b[8][0]++;cov_1boptpdvjn().s[30]++;await step.context.sendActivity(this.form);}else{cov_1boptpdvjn().b[8][1]++;cov_1boptpdvjn().s[31]++;await step.context.sendActivity('Form recognition failed.');}}else{cov_1boptpdvjn().b[7][1]++;cov_1boptpdvjn().s[32]++;if(choice=='QnA about it'){cov_1boptpdvjn().b[9][0]++;cov_1boptpdvjn().s[33]++;if(this.query){cov_1boptpdvjn().b[10][0]++;cov_1boptpdvjn().s[34]++;return await step.prompt(TEXT_PROMPT,{prompt:'What is the question?'});}else{cov_1boptpdvjn().b[10][1]++;cov_1boptpdvjn().s[35]++;await step.context.sendActivity('QA system preprocessing failed.');}}else{cov_1boptpdvjn().b[9][1]++;cov_1boptpdvjn().s[36]++;return await step.endDialog();}}}cov_1boptpdvjn().s[37]++;return await step.replaceDialog(this.initialDialogId,{restartMsg:'What else can I do for you?'});}async answerStep(step){cov_1boptpdvjn().f[3]++;cov_1boptpdvjn().s[38]++;// var question = step.result;
// console.log('question: ' + question);
// let answer = await axios.get('http://51.11.38.199:5000?query="'+question)
// .then(v => v.data)
// .catch(function (error) {
//     console.log(error);
// });
// await step.context.sendActivity(answer);
await step.context.sendActivity('More functions to be updating...');cov_1boptpdvjn().s[39]++;return await step.replaceDialog(this.initialDialogId,{restartMsg:'What else can I do for you?'});}// async sumText(step) {
//     var form = new FormData();
//     const FileName = path.join(__dirname, 'text.pdf');
//     form.append("file", fse.createReadStream(FileName));
//     let r = await axios({
//         method: "post",
//         url: "https://textsumapi.azurewebsites.net/api/textsumapi",
//         data: form,
//         headers: form.getHeaders()
//     }).then(v => v.data);
//     console.log(r); // ok
//     await step.context.sendActivity(r);
// }
set a(n){cov_1boptpdvjn().f[4]++;cov_1boptpdvjn().s[40]++;this.sum=n;}set b(n){cov_1boptpdvjn().f[5]++;cov_1boptpdvjn().s[41]++;this.query=n;}set c(n){cov_1boptpdvjn().f[6]++;cov_1boptpdvjn().s[42]++;this.form=n;}}cov_1boptpdvjn().s[43]++;module.exports.DocDialog=DocDialog;cov_1boptpdvjn().s[44]++;module.exports.DOC_DIALOG=DOC_DIALOG;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRvY0RpYWxvZy5qcyJdLCJuYW1lcyI6WyJDb21wb25lbnREaWFsb2ciLCJDaG9pY2VGYWN0b3J5IiwiQ2hvaWNlUHJvbXB0IiwiVGV4dFByb21wdCIsIldhdGVyZmFsbERpYWxvZyIsInJlcXVpcmUiLCJET0NfRElBTE9HIiwiV0FURVJGQUxMX0RJQUxPRyIsIlRFWFRfUFJPTVBUIiwiQ0hPSUNFX1BST01QVCIsIkRvY0RpYWxvZyIsImNvbnN0cnVjdG9yIiwibWFpbklkIiwic3VtIiwiZm9ybSIsInF1ZXJ5IiwiZmlsZXBhdGgiLCJhZGREaWFsb2ciLCJiZWdpblN0ZXAiLCJiaW5kIiwiZGVhbFN0ZXAiLCJhbnN3ZXJTdGVwIiwiaW5pdGlhbERpYWxvZ0lkIiwic3RlcENvbnRleHQiLCJvcHRpb25zIiwicmVzdGFydE1zZyIsInByb21wdCIsImNob2ljZXMiLCJ0b0Nob2ljZXMiLCJzdGVwIiwiY29uc29sZSIsImxvZyIsInJlc3VsdCIsInZhbHVlIiwiY2hvaWNlIiwiY29udGV4dCIsInNlbmRBY3Rpdml0eSIsImVuZERpYWxvZyIsInJlcGxhY2VEaWFsb2ciLCJhIiwibiIsImIiLCJjIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjJxTkFlWTsyRkFmWjtBQUNBO0FBRUEsS0FBTSxDQUFFQSxlQUFGLENBQW1CQyxhQUFuQixDQUFrQ0MsWUFBbEMsQ0FBZ0RDLFVBQWhELENBQTREQyxlQUE1RCwyQkFBZ0ZDLE9BQU8sQ0FBQyxvQkFBRCxDQUF2RixDQUFOLENBQ0EsS0FBTUMsQ0FBQUEsVUFBVSwwQkFBRyxZQUFILENBQWhCLENBQ0EsS0FBTUMsQ0FBQUEsZ0JBQWdCLDBCQUFHLGtCQUFILENBQXRCLENBQ0EsS0FBTUMsQ0FBQUEsV0FBVywwQkFBRyxhQUFILENBQWpCLENBQ0EsS0FBTUMsQ0FBQUEsYUFBYSwwQkFBRyxlQUFILENBQW5CLENBR0EsS0FBTUMsQ0FBQUEsU0FBTixRQUF3QlYsQ0FBQUEsZUFBZ0IsQ0FDcENXLFdBQVcsQ0FB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WUFBYixDQUEwQixrQ0FBMUIsQ0FBTixDQVRtQix5QkFVbkIsTUFBTyxNQUFNUCxDQUFBQSxJQUFJLENBQUNTLGFBQUwsQ0FBbUIsS0FBS2hCLGVBQXhCLENBQXlDLENBQUVHLFVBQVUsQ0FBRSw2QkFBZCxDQUF6QyxDQUFiLENBQ0gsQ0FFRDtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNLLEdBQURjLENBQUFBLENBQUMsQ0FBQ0MsQ0FBRCxDQUFHLGtEQUNKLEtBQUszQixHQUFMLENBQVcyQixDQUFYLENBQ0gsQ0FDSSxHQUFEQyxDQUFBQSxDQUFDLENBQUNELENBQUQsQ0FBRyxrREFDSixLQUFLekIsS0FBTCxDQUFheUIsQ0FBYixDQUNILENBQ0ksR0FBREUsQ0FBQUEsQ0FBQyxDQUFDRixDQUFELENBQUcsa0RBQ0osS0FBSzFCLElBQUwsQ0FBWTBCLENBQVosQ0FDSCxDQS9HbUMsQyx5QkFrSHhDRyxNQUFNLENBQUNDLE9BQVAsQ0FBZWxDLFNBQWYsQ0FBMkJBLFNBQTNCLEMseUJBQ0FpQyxNQUFNLENBQUNDLE9BQVAsQ0FBZXRDLFVBQWYsQ0FBNEJBLFVBQTVCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuXHJcbmNvbnN0IHsgQ29tcG9uZW50RGlhbG9nLCBDaG9pY2VGYWN0b3J5LCBDaG9pY2VQcm9tcHQsIFRleHRQcm9tcHQsIFdhdGVyZmFsbERpYWxvZyB9ID0gcmVxdWlyZSgnYm90YnVpbGRlci1kaWFsb2dzJyk7XHJcbmNvbnN0IERPQ19ESUFMT0cgPSAnRE9DX0RJQUxPRyc7XHJcbmNvbnN0IFdBVEVSRkFMTF9ESUFMT0cgPSAnV0FURVJGQUxMX0RJQUxPRyc7XHJcbmNvbnN0IFRFWFRfUFJPTVBUID0gJ1RFWFRfUFJPTVBUJztcclxuY29uc3QgQ0hPSUNFX1BST01QVCA9ICdDSE9JQ0VfUFJPTVBUJztcclxuXHJcblxyXG5jbGFzcyBEb2NEaWFsb2cgZXh0ZW5kcyBDb21wb25lbnREaWFsb2cge1xyXG4gICAgY29uc3RydWN0b3IobWFpbklkKSB7XHJcbiAgICAgICAgc3VwZXIoRE9DX0RJQUxPRyk7XHJcbiAgICAgICAgdGhpcy5tYWluSWQgPSBtYWluSWQ7XHJcbiAgICAgICAgdGhpcy5zdW0gPSAnJztcclxuICAgICAgICB0aGlzLmZvcm0gPSAnJztcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gJyc7XHJcbiAgICAgICAgdGhpcy5maWxlcGF0aCA9ICcnO1xyXG5cclxuICAgICAgICB0aGlzLmFkZERpYWxvZyhuZXcgVGV4dFByb21wdChURVhUX1BST01QVCkpO1xyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBDaG9pY2VQcm9tcHQoQ0hPSUNFX1BST01QVCkpO1xyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBXYXRlcmZhbGxEaWFsb2coV0FURVJGQUxMX0RJQUxPRywgW1xyXG4gICAgICAgICAgICB0aGlzLmJlZ2luU3RlcC5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICB0aGlzLmRlYWxTdGVwLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIHRoaXMuYW5zd2VyU3RlcC5iaW5kKHRoaXMpXHJcbiAgICAgICAgXSkpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRpYWxEaWFsb2dJZCA9IFdBVEVSRkFMTF9ESUFMT0c7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgYmVnaW5TdGVwKHN0ZXBDb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKHN0ZXBDb250ZXh0Lm9wdGlvbnMucmVzdGFydE1zZykge1xyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgc3RlcENvbnRleHQucHJvbXB0KENIT0lDRV9QUk9NUFQsIHtcclxuICAgICAgICAgICAgICAgIHByb21wdDogJ0FueXRoaW5nIGVsc2UgZm9yIHRoZSBkb2N1bWVudD8nLFxyXG4gICAgICAgICAgICAgICAgY2hvaWNlczogQ2hvaWNlRmFjdG9yeS50b0Nob2ljZXMoWydzdW1tYXJpemUgaXQnLCAnZXh0cmFjdCB0YWJsZScsICdRbkEgYWJvdXQgaXQnLCAnbm8nXSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnN1bSA9IHN0ZXBDb250ZXh0Lm9wdGlvbnMuc3VtID8gc3RlcENvbnRleHQub3B0aW9ucy5zdW0gOiB0aGlzLnN1bTtcclxuICAgICAgICAgICAgdGhpcy5xdWVyeSA9IHN0ZXBDb250ZXh0Lm9wdGlvbnMucXVlcnkgPyBzdGVwQ29udGV4dC5vcHRpb25zLnF1ZXJ5IDogdGhpcy5xdWVyeTtcclxuICAgICAgICAgICAgdGhpcy5mb3JtID0gc3RlcENvbnRleHQub3B0aW9ucy5mb3JtID8gc3RlcENvbnRleHQub3B0aW9ucy5mb3JtIDogdGhpcy5mb3JtO1xyXG4gICAgICAgICAgICB0aGlzLmZpbGVwYXRoID0gc3RlcENvbnRleHQub3B0aW9ucy5maWxlcGF0aCA/IHN0ZXBDb250ZXh0Lm9wdGlvbnMuZmlsZXBhdGggOiB0aGlzLmZpbGVwYXRoO1xyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgc3RlcENvbnRleHQucHJvbXB0KENIT0lDRV9QUk9NUFQsIHtcclxuICAgICAgICAgICAgICAgIHByb21wdDogJ0hvdyBjYW4gSSBoZWxwIHdpdGggdGhlIGRvY3VtZW50PycsXHJcbiAgICAgICAgICAgICAgICBjaG9pY2VzOiBDaG9pY2VGYWN0b3J5LnRvQ2hvaWNlcyhbJ3N1bW1hcml6ZSBpdCcsICdleHRyYWN0IHRhYmxlJywgJ1FuQSBhYm91dCBpdCddKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZGVhbFN0ZXAoc3RlcCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHN0ZXAucmVzdWx0LnZhbHVlKTtcclxuICAgICAgICBjb25zdCBjaG9pY2UgPSBzdGVwLnJlc3VsdC52YWx1ZTtcclxuICAgICAgICBpZiAoY2hvaWNlID09ICdzdW1tYXJpemUgaXQnKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN1bSkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eSh0aGlzLnN1bSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KCdTdW1tYXJpemF0aW9uIGZhaWxlZC4nKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hvaWNlID09ICdleHRyYWN0IHRhYmxlJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5mb3JtKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KHRoaXMuZm9ybSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KCdGb3JtIHJlY29nbml0aW9uIGZhaWxlZC4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaG9pY2UgPT0gJ1FuQSBhYm91dCBpdCcpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucXVlcnkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBzdGVwLnByb21wdChURVhUX1BST01QVCwgeyBwcm9tcHQ6ICdXaGF0IGlzIHRoZSBxdWVzdGlvbj8nIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eSgnUUEgc3lzdGVtIHByZXByb2Nlc3NpbmcgZmFpbGVkLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHN0ZXAuZW5kRGlhbG9nKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYXdhaXQgc3RlcC5yZXBsYWNlRGlhbG9nKHRoaXMuaW5pdGlhbERpYWxvZ0lkLCB7IHJlc3RhcnRNc2c6ICdXaGF0IGVsc2UgY2FuIEkgZG8gZm9yIHlvdT8nIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGFuc3dlclN0ZXAoc3RlcCkge1xyXG4gICAgICAgIC8vIHZhciBxdWVzdGlvbiA9IHN0ZXAucmVzdWx0O1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdxdWVzdGlvbjogJyArIHF1ZXN0aW9uKTtcclxuICAgICAgICAvLyBsZXQgYW5zd2VyID0gYXdhaXQgYXhpb3MuZ2V0KCdodHRwOi8vNTEuMTEuMzguMTk5OjUwMDA/cXVlcnk9XCInK3F1ZXN0aW9uKVxyXG4gICAgICAgIC8vIC50aGVuKHYgPT4gdi5kYXRhKVxyXG4gICAgICAgIC8vIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIC8vIGF3YWl0IHN0ZXAuY29udGV4dC5zZW5kQWN0aXZpdHkoYW5zd2VyKTtcclxuICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KCdNb3JlIGZ1bmN0aW9ucyB0byBiZSB1cGRhdGluZy4uLicpO1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBzdGVwLnJlcGxhY2VEaWFsb2codGhpcy5pbml0aWFsRGlhbG9nSWQsIHsgcmVzdGFydE1zZzogJ1doYXQgZWxzZSBjYW4gSSBkbyBmb3IgeW91PycgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYXN5bmMgc3VtVGV4dChzdGVwKSB7XHJcbiAgICAvLyAgICAgdmFyIGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcclxuICAgIC8vICAgICBjb25zdCBGaWxlTmFtZSA9IHBhdGguam9pbihfX2Rpcm5hbWUsICd0ZXh0LnBkZicpO1xyXG4gICAgLy8gICAgIGZvcm0uYXBwZW5kKFwiZmlsZVwiLCBmc2UuY3JlYXRlUmVhZFN0cmVhbShGaWxlTmFtZSkpO1xyXG5cclxuICAgIC8vICAgICBsZXQgciA9IGF3YWl0IGF4aW9zKHtcclxuICAgIC8vICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgIC8vICAgICAgICAgdXJsOiBcImh0dHBzOi8vdGV4dHN1bWFwaS5henVyZXdlYnNpdGVzLm5ldC9hcGkvdGV4dHN1bWFwaVwiLFxyXG4gICAgLy8gICAgICAgICBkYXRhOiBmb3JtLFxyXG4gICAgLy8gICAgICAgICBoZWFkZXJzOiBmb3JtLmdldEhlYWRlcnMoKVxyXG4gICAgLy8gICAgIH0pLnRoZW4odiA9PiB2LmRhdGEpO1xyXG5cclxuICAgIC8vICAgICBjb25zb2xlLmxvZyhyKTsgLy8gb2tcclxuICAgIC8vICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KHIpO1xyXG4gICAgLy8gfVxyXG4gICAgc2V0IGEobil7XHJcbiAgICAgICAgdGhpcy5zdW0gPSBuO1xyXG4gICAgfVxyXG4gICAgc2V0IGIobil7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IG47XHJcbiAgICB9XHJcbiAgICBzZXQgYyhuKXtcclxuICAgICAgICB0aGlzLmZvcm0gPSBuO1xyXG4gICAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cy5Eb2NEaWFsb2cgPSBEb2NEaWFsb2c7XHJcbm1vZHVsZS5leHBvcnRzLkRPQ19ESUFMT0cgPSBET0NfRElBTE9HOyJdfQ==