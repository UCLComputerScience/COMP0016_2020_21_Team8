function cov_13uzh0bhr2(){var path="/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/mainDialog.js";var hash="0266f0aa173cb1efc1a4400e0da270952db66127";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/mainDialog.js",statementMap:{"0":{start:{line:4,column:13},end:{line:4,column:28}},"1":{start:{line:5,column:14},end:{line:5,column:30}},"2":{start:{line:6,column:11},end:{line:6,column:24}},"3":{start:{line:7,column:12},end:{line:7,column:31}},"4":{start:{line:8,column:15},end:{line:8,column:35}},"5":{start:{line:19,column:4},end:{line:19,column:33}},"6":{start:{line:20,column:40},end:{line:20,column:65}},"7":{start:{line:21,column:34},end:{line:21,column:56}},"8":{start:{line:23,column:26},end:{line:23,column:45}},"9":{start:{line:24,column:22},end:{line:24,column:37}},"10":{start:{line:25,column:23},end:{line:25,column:39}},"11":{start:{line:26,column:25},end:{line:26,column:43}},"12":{start:{line:30,column:8},end:{line:30,column:28}},"13":{start:{line:32,column:8},end:{line:32,column:43}},"14":{start:{line:33,column:8},end:{line:33,column:60}},"15":{start:{line:34,column:8},end:{line:34,column:53}},"16":{start:{line:35,column:8},end:{line:35,column:56}},"17":{start:{line:36,column:8},end:{line:36,column:58}},"18":{start:{line:37,column:8},end:{line:37,column:86}},"19":{start:{line:39,column:8},end:{line:44,column:12}},"20":{start:{line:46,column:8},end:{line:46,column:48}},"21":{start:{line:56,column:26},end:{line:56,column:49}},"22":{start:{line:57,column:8},end:{line:57,column:28}},"23":{start:{line:59,column:30},end:{line:59,column:72}},"24":{start:{line:60,column:24},end:{line:60,column:60}},"25":{start:{line:61,column:8},end:{line:63,column:9}},"26":{start:{line:62,column:12},end:{line:62,column:53}},"27":{start:{line:69,column:20},end:{line:69,column:96}},"28":{start:{line:70,column:8},end:{line:73,column:11}},"29":{start:{line:77,column:23},end:{line:77,column:40}},"30":{start:{line:78,column:8},end:{line:96,column:9}},"31":{start:{line:79,column:12},end:{line:79,column:57}},"32":{start:{line:81,column:13},end:{line:96,column:9}},"33":{start:{line:82,column:32},end:{line:85,column:13}},"34":{start:{line:87,column:12},end:{line:87,column:71}},"35":{start:{line:90,column:32},end:{line:93,column:13}},"36":{start:{line:95,column:12},end:{line:95,column:71}},"37":{start:{line:101,column:8},end:{line:140,column:9}},"38":{start:{line:102,column:12},end:{line:102,column:52}},"39":{start:{line:103,column:23},end:{line:103,column:49}},"40":{start:{line:104,column:12},end:{line:138,column:13}},"41":{start:{line:105,column:27},end:{line:105,column:76}},"42":{start:{line:106,column:16},end:{line:106,column:45}},"43":{start:{line:107,column:16},end:{line:107,column:88}},"44":{start:{line:108,column:34},end:{line:108,column:58}},"45":{start:{line:109,column:16},end:{line:109,column:144}},"46":{start:{line:112,column:35},end:{line:112,column:37}},"47":{start:{line:113,column:27},end:{line:113,column:76}},"48":{start:{line:114,column:16},end:{line:114,column:85}},"49":{start:{line:115,column:27},end:{line:115,column:41}},"50":{start:{line:116,column:16},end:{line:116,column:64}},"51":{start:{line:117,column:16},end:{line:131,column:23}},"52":{start:{line:124,column:32},end:{line:124,column:45}},"53":{start:{line:125,column:24},end:{line:127,column:27}},"54":{start:{line:126,column:28},end:{line:126,column:56}},"55":{start:{line:130,column:24},end:{line:130,column:43}},"56":{start:{line:132,column:16},end:{line:137,column:17}},"57":{start:{line:133,column:20},end:{line:133,column:66}},"58":{start:{line:136,column:20},end:{line:136,column:80}},"59":{start:{line:141,column:8},end:{line:141,column:32}},"60":{start:{line:146,column:8},end:{line:146,column:109}},"61":{start:{line:150,column:20},end:{line:150,column:34}},"62":{start:{line:151,column:8},end:{line:151,column:57}},"63":{start:{line:152,column:20},end:{line:152,column:34}},"64":{start:{line:153,column:8},end:{line:153,column:57}},"65":{start:{line:154,column:20},end:{line:154,column:34}},"66":{start:{line:155,column:8},end:{line:155,column:57}},"67":{start:{line:157,column:21},end:{line:172,column:11}},"68":{start:{line:173,column:21},end:{line:173,column:23}},"69":{start:{line:174,column:8},end:{line:186,column:10}},"70":{start:{line:175,column:12},end:{line:184,column:14}},"71":{start:{line:176,column:16},end:{line:176,column:43}},"72":{start:{line:177,column:16},end:{line:182,column:17}},"73":{start:{line:178,column:20},end:{line:178,column:51}},"74":{start:{line:179,column:20},end:{line:179,column:63}},"75":{start:{line:181,column:20},end:{line:181,column:35}},"76":{start:{line:188,column:8},end:{line:188,column:28}},"77":{start:{line:189,column:8},end:{line:189,column:28}},"78":{start:{line:190,column:8},end:{line:190,column:22}},"79":{start:{line:195,column:25},end:{line:195,column:100}},"80":{start:{line:196,column:32},end:{line:196,column:59}},"81":{start:{line:201,column:12},end:{line:209,column:13}},"82":{start:{line:204,column:16},end:{line:205,column:42}},"83":{start:{line:208,column:16},end:{line:208,column:85}},"84":{start:{line:210,column:12},end:{line:210,column:48}},"85":{start:{line:215,column:30},end:{line:215,column:96}},"86":{start:{line:216,column:16},end:{line:216,column:74}},"87":{start:{line:216,column:64},end:{line:216,column:73}},"88":{start:{line:217,column:8},end:{line:217,column:16}},"89":{start:{line:222,column:19},end:{line:222,column:76}},"90":{start:{line:223,column:8},end:{line:223,column:26}},"91":{start:{line:225,column:20},end:{line:225,column:41}},"92":{start:{line:228,column:30},end:{line:228,column:56}},"93":{start:{line:230,column:8},end:{line:241,column:9}},"94":{start:{line:232,column:29},end:{line:232,column:82}},"95":{start:{line:233,column:12},end:{line:237,column:15}},"96":{start:{line:234,column:16},end:{line:236,column:17}},"97":{start:{line:235,column:20},end:{line:235,column:34}},"98":{start:{line:239,column:12},end:{line:239,column:33}},"99":{start:{line:240,column:12},end:{line:240,column:29}},"100":{start:{line:244,column:8},end:{line:247,column:10}},"101":{start:{line:253,column:8},end:{line:276,column:9}},"102":{start:{line:254,column:26},end:{line:254,column:54}},"103":{start:{line:255,column:30},end:{line:255,column:60}},"104":{start:{line:256,column:27},end:{line:256,column:29}},"105":{start:{line:258,column:12},end:{line:265,column:15}},"106":{start:{line:259,column:16},end:{line:264,column:17}},"107":{start:{line:260,column:20},end:{line:260,column:46}},"108":{start:{line:262,column:21},end:{line:264,column:17}},"109":{start:{line:263,column:20},end:{line:263,column:46}},"110":{start:{line:267,column:12},end:{line:267,column:54}},"111":{start:{line:270,column:12},end:{line:270,column:37}},"112":{start:{line:272,column:12},end:{line:272,column:81}},"113":{start:{line:275,column:12},end:{line:275,column:24}},"114":{start:{line:281,column:0},end:{line:281,column:39}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:29,column:4},end:{line:29,column:5}},loc:{start:{line:29,column:18},end:{line:47,column:5}},line:29},"1":{name:"(anonymous_1)",decl:{start:{line:55,column:4},end:{line:55,column:5}},loc:{start:{line:55,column:37},end:{line:64,column:5}},line:55},"2":{name:"(anonymous_2)",decl:{start:{line:66,column:4},end:{line:66,column:5}},loc:{start:{line:66,column:26},end:{line:74,column:5}},line:66},"3":{name:"(anonymous_3)",decl:{start:{line:76,column:4},end:{line:76,column:5}},loc:{start:{line:76,column:27},end:{line:98,column:5}},line:76},"4":{name:"(anonymous_4)",decl:{start:{line:100,column:4},end:{line:100,column:5}},loc:{start:{line:100,column:24},end:{line:142,column:5}},line:100},"5":{name:"(anonymous_5)",decl:{start:{line:123,column:26},end:{line:123,column:27}},loc:{start:{line:123,column:46},end:{line:128,column:21}},line:123},"6":{name:"(anonymous_6)",decl:{start:{line:125,column:34},end:{line:125,column:35}},loc:{start:{line:125,column:42},end:{line:127,column:25}},line:125},"7":{name:"(anonymous_7)",decl:{start:{line:129,column:27},end:{line:129,column:28}},loc:{start:{line:129,column:44},end:{line:131,column:21}},line:129},"8":{name:"(anonymous_8)",decl:{start:{line:145,column:4},end:{line:145,column:5}},loc:{start:{line:145,column:27},end:{line:147,column:5}},line:145},"9":{name:"(anonymous_9)",decl:{start:{line:149,column:4},end:{line:149,column:5}},loc:{start:{line:149,column:24},end:{line:191,column:5}},line:149},"10":{name:"(anonymous_10)",decl:{start:{line:174,column:46},end:{line:174,column:47}},loc:{start:{line:174,column:57},end:{line:186,column:9}},line:174},"11":{name:"(anonymous_11)",decl:{start:{line:175,column:28},end:{line:175,column:29}},loc:{start:{line:175,column:38},end:{line:184,column:13}},line:175},"12":{name:"(anonymous_12)",decl:{start:{line:193,column:4},end:{line:193,column:5}},loc:{start:{line:193,column:48},end:{line:219,column:5}},line:193},"13":{name:"replyForReceivedAttachments",decl:{start:{line:200,column:23},end:{line:200,column:50}},loc:{start:{line:200,column:72},end:{line:211,column:9}},line:200},"14":{name:"(anonymous_14)",decl:{start:{line:216,column:54},end:{line:216,column:55}},loc:{start:{line:216,column:64},end:{line:216,column:73}},line:216},"15":{name:"(anonymous_15)",decl:{start:{line:221,column:4},end:{line:221,column:5}},loc:{start:{line:221,column:49},end:{line:248,column:5}},line:221},"16":{name:"(anonymous_16)",decl:{start:{line:233,column:55},end:{line:233,column:56}},loc:{start:{line:233,column:68},end:{line:237,column:13}},line:233},"17":{name:"(anonymous_17)",decl:{start:{line:252,column:4},end:{line:252,column:5}},loc:{start:{line:252,column:41},end:{line:277,column:5}},line:252},"18":{name:"(anonymous_18)",decl:{start:{line:258,column:32},end:{line:258,column:33}},loc:{start:{line:258,column:46},end:{line:265,column:13}},line:258}},branchMap:{"0":{loc:{start:{line:61,column:8},end:{line:63,column:9}},type:"if",locations:[{start:{line:61,column:8},end:{line:63,column:9}},{start:{line:61,column:8},end:{line:63,column:9}}],line:61},"1":{loc:{start:{line:69,column:20},end:{line:69,column:96}},type:"cond-expr",locations:[{start:{line:69,column:46},end:{line:69,column:69}},{start:{line:69,column:72},end:{line:69,column:96}}],line:69},"2":{loc:{start:{line:78,column:8},end:{line:96,column:9}},type:"if",locations:[{start:{line:78,column:8},end:{line:96,column:9}},{start:{line:78,column:8},end:{line:96,column:9}}],line:78},"3":{loc:{start:{line:81,column:13},end:{line:96,column:9}},type:"if",locations:[{start:{line:81,column:13},end:{line:96,column:9}},{start:{line:81,column:13},end:{line:96,column:9}}],line:81},"4":{loc:{start:{line:101,column:8},end:{line:140,column:9}},type:"if",locations:[{start:{line:101,column:8},end:{line:140,column:9}},{start:{line:101,column:8},end:{line:140,column:9}}],line:101},"5":{loc:{start:{line:101,column:12},end:{line:101,column:52}},type:"binary-expr",locations:[{start:{line:101,column:12},end:{line:101,column:23}},{start:{line:101,column:27},end:{line:101,column:52}}],line:101},"6":{loc:{start:{line:104,column:12},end:{line:138,column:13}},type:"if",locations:[{start:{line:104,column:12},end:{line:138,column:13}},{start:{line:104,column:12},end:{line:138,column:13}}],line:104},"7":{loc:{start:{line:132,column:16},end:{line:137,column:17}},type:"if",locations:[{start:{line:132,column:16},end:{line:137,column:17}},{start:{line:132,column:16},end:{line:137,column:17}}],line:132},"8":{loc:{start:{line:177,column:16},end:{line:182,column:17}},type:"if",locations:[{start:{line:177,column:16},end:{line:182,column:17}},{start:{line:177,column:16},end:{line:182,column:17}}],line:177},"9":{loc:{start:{line:201,column:12},end:{line:209,column:13}},type:"if",locations:[{start:{line:201,column:12},end:{line:209,column:13}},{start:{line:201,column:12},end:{line:209,column:13}}],line:201},"10":{loc:{start:{line:234,column:16},end:{line:236,column:17}},type:"if",locations:[{start:{line:234,column:16},end:{line:236,column:17}},{start:{line:234,column:16},end:{line:236,column:17}}],line:234},"11":{loc:{start:{line:253,column:8},end:{line:276,column:9}},type:"if",locations:[{start:{line:253,column:8},end:{line:276,column:9}},{start:{line:253,column:8},end:{line:276,column:9}}],line:253},"12":{loc:{start:{line:259,column:16},end:{line:264,column:17}},type:"if",locations:[{start:{line:259,column:16},end:{line:264,column:17}},{start:{line:259,column:16},end:{line:264,column:17}}],line:259},"13":{loc:{start:{line:259,column:20},end:{line:259,column:114}},type:"binary-expr",locations:[{start:{line:259,column:20},end:{line:259,column:66}},{start:{line:259,column:70},end:{line:259,column:114}}],line:259},"14":{loc:{start:{line:262,column:21},end:{line:264,column:17}},type:"if",locations:[{start:{line:262,column:21},end:{line:264,column:17}},{start:{line:262,column:21},end:{line:264,column:17}}],line:262},"15":{loc:{start:{line:262,column:25},end:{line:262,column:149}},type:"binary-expr",locations:[{start:{line:262,column:25},end:{line:262,column:62}},{start:{line:262,column:67},end:{line:262,column:106}},{start:{line:262,column:110},end:{line:262,column:148}}],line:262}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"0266f0aa173cb1efc1a4400e0da270952db66127"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_13uzh0bhr2=function(){return actualCoverage;};}return actualCoverage;}cov_13uzh0bhr2();// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
const path=(cov_13uzh0bhr2().s[0]++,require('path'));const axios=(cov_13uzh0bhr2().s[1]++,require('axios'));const fs=(cov_13uzh0bhr2().s[2]++,require('fs'));const fse=(cov_13uzh0bhr2().s[3]++,require("fs-extra"));var FormData=(cov_13uzh0bhr2().s[4]++,require("form-data"));const{AttachmentPrompt,ChoiceFactory,ChoicePrompt,ComponentDialog,ConfirmPrompt,DialogSet,DialogTurnStatus,TextPrompt,WaterfallDialog}=(cov_13uzh0bhr2().s[5]++,require('botbuilder-dialogs'));const{AnswerDialog,ANSWER_DIALOG}=(cov_13uzh0bhr2().s[6]++,require('./answerDialog'));const{DocDialog,DOC_DIALOG}=(cov_13uzh0bhr2().s[7]++,require('./docDialog'));const ATTACHMENT_PROMPT=(cov_13uzh0bhr2().s[8]++,'ATTACHMENT_PROMPT');const CHOICE_PROMPT=(cov_13uzh0bhr2().s[9]++,'CHOICE_PROMPT');const CONFIRM_PROMPT=(cov_13uzh0bhr2().s[10]++,'CONFIRM_PROMPT');const WATERFALL_DIALOG=(cov_13uzh0bhr2().s[11]++,'WATERFALL_DIALOG');class MainDialog extends ComponentDialog{constructor(){cov_13uzh0bhr2().f[0]++;cov_13uzh0bhr2().s[12]++;super('mainDialog');cov_13uzh0bhr2().s[13]++;this.addDialog(new AnswerDialog());cov_13uzh0bhr2().s[14]++;this.addDialog(new DocDialog(this.initialDialogId));cov_13uzh0bhr2().s[15]++;this.addDialog(new TextPrompt('TextPrompt'));cov_13uzh0bhr2().s[16]++;this.addDialog(new ChoicePrompt(CHOICE_PROMPT));cov_13uzh0bhr2().s[17]++;this.addDialog(new ConfirmPrompt(CONFIRM_PROMPT));cov_13uzh0bhr2().s[18]++;this.addDialog(new AttachmentPrompt(ATTACHMENT_PROMPT,this.promptValidator));cov_13uzh0bhr2().s[19]++;this.addDialog(new WaterfallDialog(WATERFALL_DIALOG,[this.startStep.bind(this),this.chooseStep.bind(this),this.docStep.bind(this),this.repeatStep.bind(this)]));cov_13uzh0bhr2().s[20]++;this.initialDialogId=WATERFALL_DIALOG;}/**
     * The run method handles the incoming activity (in the form of a TurnContext) and passes it through the dialog system.
     * If no dialog is active, it will start the default dialog.
     * @param {*} turnContext
     * @param {*} accessor
     */async run(turnContext,accessor){cov_13uzh0bhr2().f[1]++;const dialogSet=(cov_13uzh0bhr2().s[21]++,new DialogSet(accessor));cov_13uzh0bhr2().s[22]++;dialogSet.add(this);const dialogContext=(cov_13uzh0bhr2().s[23]++,await dialogSet.createContext(turnContext));const results=(cov_13uzh0bhr2().s[24]++,await dialogContext.continueDialog());cov_13uzh0bhr2().s[25]++;if(results.status===DialogTurnStatus.empty){cov_13uzh0bhr2().b[0][0]++;cov_13uzh0bhr2().s[26]++;await dialogContext.beginDialog(this.id);}else{cov_13uzh0bhr2().b[0][1]++;}}async startStep(step){cov_13uzh0bhr2().f[2]++;// WaterfallStep always finishes with the end of the Waterfall or with another dialog; here it is a Prompt Dialog.
// Running a prompt here means the next WaterfallStep will be run when the user's response is received.
const msg=(cov_13uzh0bhr2().s[27]++,step.options.restartMsg?(cov_13uzh0bhr2().b[1][0]++,step.options.restartMsg):(cov_13uzh0bhr2().b[1][1]++,'What can I do for you?'));cov_13uzh0bhr2().s[28]++;return await step.prompt(CHOICE_PROMPT,{prompt:msg,choices:ChoiceFactory.toChoices(['ask a question','process a document',,'recognize an image'])});}async chooseStep(step){cov_13uzh0bhr2().f[3]++;const choice=(cov_13uzh0bhr2().s[29]++,step.result.value);cov_13uzh0bhr2().s[30]++;if(choice=='ask a question'){cov_13uzh0bhr2().b[2][0]++;cov_13uzh0bhr2().s[31]++;return await step.beginDialog(ANSWER_DIALOG);}else{cov_13uzh0bhr2().b[2][1]++;cov_13uzh0bhr2().s[32]++;if(choice=='process a document'){cov_13uzh0bhr2().b[3][0]++;var promptOptions=(cov_13uzh0bhr2().s[33]++,{prompt:'Please attach a document in pdf.',retryPrompt:'That was not a document that I can help, please try again.'});cov_13uzh0bhr2().s[34]++;return await step.prompt(ATTACHMENT_PROMPT,promptOptions);}else{cov_13uzh0bhr2().b[3][1]++;var promptOptions=(cov_13uzh0bhr2().s[35]++,{prompt:'Please attach an image.',retryPrompt:'That was not an image that I can help, please try again.'});cov_13uzh0bhr2().s[36]++;return await step.prompt(ATTACHMENT_PROMPT,promptOptions);}}}async docStep(step){cov_13uzh0bhr2().f[4]++;cov_13uzh0bhr2().s[37]++;if((cov_13uzh0bhr2().b[5][0]++,step.result)&&(cov_13uzh0bhr2().b[5][1]++,step.result[0].contentUrl)){cov_13uzh0bhr2().b[4][0]++;cov_13uzh0bhr2().s[38]++;console.log(step.result[0].contentType);var type=(cov_13uzh0bhr2().s[39]++,step.result[0].contentType);cov_13uzh0bhr2().s[40]++;if(type==='application/pdf'){cov_13uzh0bhr2().b[6][0]++;var path=(cov_13uzh0bhr2().s[41]++,await this.handleIncomingAttachment(step.context));cov_13uzh0bhr2().s[42]++;console.log('path: '+path);cov_13uzh0bhr2().s[43]++;await step.context.sendActivity('Processing the document, please wait');var req_results=(cov_13uzh0bhr2().s[44]++,await this.sendReq(path));cov_13uzh0bhr2().s[45]++;return await step.beginDialog(DOC_DIALOG,{sum:req_results[0],query:req_results[1],form:req_results[2],filepath:path});}else{cov_13uzh0bhr2().b[6][1]++;var image_result=(cov_13uzh0bhr2().s[46]++,'');var path=(cov_13uzh0bhr2().s[47]++,await this.handleIncomingAttachment(step.context));cov_13uzh0bhr2().s[48]++;await step.context.sendActivity('Processing the image, please wait');var form=(cov_13uzh0bhr2().s[49]++,new FormData());cov_13uzh0bhr2().s[50]++;form.append("file",fse.createReadStream(path));cov_13uzh0bhr2().s[51]++;await axios({method:"post",url:'http://avabotformrecog.azurewebsites.net/api/FormRecogFunction?type=BusinessCard',data:form,headers:form.getHeaders()}).then(function(response){cov_13uzh0bhr2().f[5]++;var a=(cov_13uzh0bhr2().s[52]++,response.data);cov_13uzh0bhr2().s[53]++;a.forEach(line=>{cov_13uzh0bhr2().f[6]++;cov_13uzh0bhr2().s[54]++;image_result+=line+'\n';});}).catch(function(error){cov_13uzh0bhr2().f[7]++;cov_13uzh0bhr2().s[55]++;console.log(error);});cov_13uzh0bhr2().s[56]++;if(image_result){cov_13uzh0bhr2().b[7][0]++;cov_13uzh0bhr2().s[57]++;await step.context.sendActivity(image_result);}else{cov_13uzh0bhr2().b[7][1]++;cov_13uzh0bhr2().s[58]++;await step.context.sendActivity('Image recognition failed');}}}else{cov_13uzh0bhr2().b[4][1]++;}cov_13uzh0bhr2().s[59]++;return await step.next();}async repeatStep(step){cov_13uzh0bhr2().f[8]++;cov_13uzh0bhr2().s[60]++;return await step.replaceDialog(this.initialDialogId,{restartMsg:'What else can I do for you?'});}async sendReq(path){cov_13uzh0bhr2().f[9]++;var form1=(cov_13uzh0bhr2().s[61]++,new FormData());cov_13uzh0bhr2().s[62]++;form1.append("file",fse.createReadStream(path));var form2=(cov_13uzh0bhr2().s[63]++,new FormData());cov_13uzh0bhr2().s[64]++;form2.append("file",fse.createReadStream(path));var form3=(cov_13uzh0bhr2().s[65]++,new FormData());cov_13uzh0bhr2().s[66]++;form3.append("file",fse.createReadStream(path));let reqArr=(cov_13uzh0bhr2().s[67]++,[axios({method:"post",url:"https://textsumapi.azurewebsites.net/api/TextSummary",data:form1,headers:form1.getHeaders()}),axios({method:"post",url:"http://51.11.182.5:5000",data:form2,headers:form2.getHeaders()}),axios({method:"post",url:"https://avabotformrecog.azurewebsites.net/api/FormRecogFunction?type=Layout",data:form3,headers:form3.getHeaders()})]);var output=(cov_13uzh0bhr2().s[68]++,[]);cov_13uzh0bhr2().s[69]++;await Promise.allSettled(reqArr).then(results=>{cov_13uzh0bhr2().f[10]++;cov_13uzh0bhr2().s[70]++;results.forEach(result=>{cov_13uzh0bhr2().f[11]++;cov_13uzh0bhr2().s[71]++;console.log(result.status);cov_13uzh0bhr2().s[72]++;if(result.status=='fulfilled'){cov_13uzh0bhr2().b[8][0]++;cov_13uzh0bhr2().s[73]++;output.push(result.value.data);cov_13uzh0bhr2().s[74]++;console.log('first: '+result.value.data);}else{cov_13uzh0bhr2().b[8][1]++;cov_13uzh0bhr2().s[75]++;output.push(0);}});});cov_13uzh0bhr2().s[76]++;console.log("完成啦！");cov_13uzh0bhr2().s[77]++;console.log(output);cov_13uzh0bhr2().s[78]++;return output;}async handleIncomingAttachment(turnContext){cov_13uzh0bhr2().f[12]++;// Prepare Promises to download each attachment and then execute each Promise.
const promises=(cov_13uzh0bhr2().s[79]++,await turnContext.activity.attachments.map(this.downloadAttachmentAndWrite));const successfulSaves=(cov_13uzh0bhr2().s[80]++,await Promise.all(promises));// Replies back to the user with information about where the attachment is stored on the bot's server,
// and what the name of the saved file is.
async function replyForReceivedAttachments(localAttachmentData){cov_13uzh0bhr2().f[13]++;cov_13uzh0bhr2().s[81]++;if(localAttachmentData){cov_13uzh0bhr2().b[9][0]++;cov_13uzh0bhr2().s[82]++;// Because the TurnContext was bound to this function, the bot can call
// `TurnContext.sendActivity` via `this.sendActivity`;
await this.sendActivity(`Attachment "${localAttachmentData.fileName}" `+`has been received.`);}else{cov_13uzh0bhr2().b[9][1]++;cov_13uzh0bhr2().s[83]++;await this.sendActivity('Attachment was not successfully received.');}cov_13uzh0bhr2().s[84]++;return localAttachmentData.localPath;}// Prepare Promises to reply to the user with information about saved attachments.
// The current TurnContext is bound so `replyForReceivedAttachments` can also send replies.
const replyPromises=(cov_13uzh0bhr2().s[85]++,successfulSaves.map(replyForReceivedAttachments.bind(turnContext)));let r=(cov_13uzh0bhr2().s[86]++,await Promise.all(replyPromises).then(result=>{cov_13uzh0bhr2().f[14]++;cov_13uzh0bhr2().s[87]++;return result[0];}));cov_13uzh0bhr2().s[88]++;return r;}async downloadAttachmentAndWrite(attachment){cov_13uzh0bhr2().f[15]++;var name=(cov_13uzh0bhr2().s[89]++,'text.'+attachment.contentType.toString().split('/')[1]);cov_13uzh0bhr2().s[90]++;console.log(name);// Retrieve the attachment via the attachment's contentUrl.
const url=(cov_13uzh0bhr2().s[91]++,attachment.contentUrl);// Local file path for the bot to save the attachment.
const localFileName=(cov_13uzh0bhr2().s[92]++,path.join(__dirname,name));cov_13uzh0bhr2().s[93]++;try{// arraybuffer is necessary for images
const response=(cov_13uzh0bhr2().s[94]++,await axios.get(url,{responseType:'arraybuffer'}));cov_13uzh0bhr2().s[95]++;fs.writeFile(localFileName,response.data,fsError=>{cov_13uzh0bhr2().f[16]++;cov_13uzh0bhr2().s[96]++;if(fsError){cov_13uzh0bhr2().b[10][0]++;cov_13uzh0bhr2().s[97]++;throw fsError;}else{cov_13uzh0bhr2().b[10][1]++;}});}catch(error){cov_13uzh0bhr2().s[98]++;console.error(error);cov_13uzh0bhr2().s[99]++;return undefined;}// If no error was thrown while writing to disk, return the attachment's name
// and localFilePath for the response back to the user.
cov_13uzh0bhr2().s[100]++;return{fileName:attachment.name,localPath:localFileName};}async promptValidator(promptContext){cov_13uzh0bhr2().f[17]++;cov_13uzh0bhr2().s[101]++;if(promptContext.recognized.succeeded){cov_13uzh0bhr2().b[11][0]++;var docType=(cov_13uzh0bhr2().s[102]++,promptContext.options.prompt);var attachments=(cov_13uzh0bhr2().s[103]++,promptContext.recognized.value);var validDoc=(cov_13uzh0bhr2().s[104]++,[]);cov_13uzh0bhr2().s[105]++;attachments.forEach(attachment=>{cov_13uzh0bhr2().f[18]++;cov_13uzh0bhr2().s[106]++;if((cov_13uzh0bhr2().b[13][0]++,docType==='Please attach a document in pdf.')&&(cov_13uzh0bhr2().b[13][1]++,attachment.contentType==='application/pdf')){cov_13uzh0bhr2().b[12][0]++;cov_13uzh0bhr2().s[107]++;//|| attachment.contentType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'|| attachment.contentType === 'application/msword'
validDoc.push(attachment);}else{cov_13uzh0bhr2().b[12][1]++;cov_13uzh0bhr2().s[108]++;if((cov_13uzh0bhr2().b[15][0]++,docType==='Please attach an image.')&&((cov_13uzh0bhr2().b[15][1]++,attachment.contentType==='image/jpeg')||(cov_13uzh0bhr2().b[15][2]++,attachment.contentType==='image/png'))){cov_13uzh0bhr2().b[14][0]++;cov_13uzh0bhr2().s[109]++;validDoc.push(attachment);}else{cov_13uzh0bhr2().b[14][1]++;}}});cov_13uzh0bhr2().s[110]++;promptContext.recognized.value=validDoc;// If none of the attachments are valid images, the retry prompt should be sent.
cov_13uzh0bhr2().s[111]++;return!!validDoc.length;}else{cov_13uzh0bhr2().b[11][1]++;cov_13uzh0bhr2().s[112]++;await promptContext.context.sendActivity('No attachments received.');// We can return true from a validator function even if Recognized.Succeeded is false.
cov_13uzh0bhr2().s[113]++;return true;}}}cov_13uzh0bhr2().s[114]++;module.exports.MainDialog=MainDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW5EaWFsb2cuanMiXSwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJheGlvcyIsImZzIiwiZnNlIiwiRm9ybURhdGEiLCJBdHRhY2htZW50UHJvbXB0IiwiQ2hvaWNlRmFjdG9yeSIsIkNob2ljZVByb21wdCIsIkNvbXBvbmVudERpYWxvZyIsIkNvbmZpcm1Qcm9tcHQiLCJEaWFsb2dTZXQiLCJEaWFsb2dUdXJuU3RhdHVzIiwiVGV4dFByb21wdCIsIldhdGVyZmFsbERpYWxvZyIsIkFuc3dlckRpYWxvZyIsIkFOU1dFUl9ESUFMT0ciLCJEb2NEaWFsb2ciLCJET0NfRElBTE9HIiwiQVRUQUNITUVOVF9QUk9NUFQiLCJDSE9JQ0VfUFJPTVBUIiwiQ09ORklSTV9QUk9NUFQiLCJXQVRFUkZBTExfRElBTE9HIiwiTWFpbkRpYWxvZyIsImNvbnN0cnVjdG9yIiwiYWRkRGlhbG9nIiwiaW5pdGlhbERpYWxvZ0lkIiwicHJvbXB0VmFsaWRhdG9yIiwic3RhcnRTdGVwIiwiYmluZCIsImNob29zZVN0ZXAiLCJkb2NTdGVwIiwicmVwZWF0U3RlcCIsInJ1biIsInR1cm5Db250ZXh0IiwiYWNjZXNzb3IiLCJkaWFsb2dTZXQiLCJhZGQiLCJkaWFsb2dDb250ZXh0IiwiY3JlYXRlQ29udGV4dCIsInJlc3VsdHMiLCJjb250aW51ZURpYWxvZyIsInN0YXR1cyIsImVtcHR5IiwiYmVnaW5EaWFsb2ciLCJpZCIsInN0ZXAiLCJtc2ciLCJvcHRpb25zIiwicmVzdGFydE1zZyIsInByb21wdCIsImNob2ljZXMiLCJ0b0Nob2ljZXMiLCJjaG9pY2UiLCJyZXN1bHQiLCJ2YWx1ZSIsInByb21wdE9wdGlvbnMiLCJyZXRyeVByb21wdCIsImNvbnRlbnRVcmwiLCJjb25zb2xlIiwibG9nIiwiY29udGVudFR5cGUiLCJ0eXBlIiwiaGFuZGxlSW5jb21pbmdBdHRhY2htZW50IiwiY29udGV4dCIsInNlbmRBY3Rpdml0eSIsInJlcV9yZXN1bHRzIiwic2VuZFJlcSIsInN1bSIsInF1ZXJ5IiwiZm9ybSIsImZpbGVwYXRoIiwiaW1hZ2VfcmVzdWx0IiwiYXBwZW5kIiwiY3JlYXRlUmVhZFN0cmVhbSIsIm1ldGhvZCIsInVybCIsImRhdGEiLCJoZWFkZXJzIiwiZ2V0SGVhZGVycyIsInRoZW4iLCJyZXNwb25zZSIsImEiLCJmb3JFYWNoIiwibGluZSIsImNhdGNoIiwiZXJyb3IiLCJuZXh0IiwicmVwbGFjZURpYWxvZyIsImZvcm0xIiwiZm9ybTIiLCJmb3JtMyIsInJlcUFyciIsIm91dHB1dCIsIlByb21pc2UiLCJhbGxTZXR0bGVkIiwicHVzaCIsInByb21pc2VzIiwiYWN0aXZpdHkiLCJhdHRhY2htZW50cyIsIm1hcCIsImRvd25sb2FkQXR0YWNobWVudEFuZFdyaXRlIiwic3VjY2Vzc2Z1bFNhdmVzIiwiYWxsIiwicmVwbHlGb3JSZWNlaXZlZEF0dGFjaG1lbnRzIiwibG9jYWxBdHRhY2htZW50RGF0YSIsImZpbGVOYW1lIiwibG9jYWxQYXRoIiwicmVwbHlQcm9taXNlcyIsInIiLCJhdHRhY2htZW50IiwibmFtZSIsInRvU3RyaW5nIiwic3BsaXQiLCJsb2NhbEZpbGVOYW1lIiwiam9pbiIsIl9fZGlybmFtZSIsImdldCIsInJlc3BvbnNlVHlwZSIsIndyaXRlRmlsZSIsImZzRXJyb3IiLCJ1bmRlZmluZWQiLCJwcm9tcHRDb250ZXh0IiwicmVjb2duaXplZCIsInN1Y2NlZWRlZCIsImRvY1R5cGUiLCJ2YWxpZERvYyIsImxlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiIrdmNBZVk7MkZBZlo7QUFDQTtBQUVBLEtBQU1BLENBQUFBLElBQUksMEJBQUdDLE9BQU8sQ0FBQyxNQUFELENBQVYsQ0FBVixDQUNBLEtBQU1DLENBQUFBLEtBQUssMEJBQUdELE9BQU8sQ0FBQyxPQUFELENBQVYsQ0FBWCxDQUNBLEtBQU1FLENBQUFBLEVBQUUsMEJBQUdGLE9BQU8sQ0FBQyxJQUFELENBQVYsQ0FBUixDQUNBLEtBQU1HLENBQUFBLEdBQUcsMEJBQUdILE9BQU8s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UUFBUSw0QkFBRyxFQUFILENBQVosQ0FIb0MsMEJBS3BDM0IsV0FBVyxDQUFDaEIsT0FBWixDQUFvQjJCLFVBQVUsRUFBSSxvREFDOUIsR0FBSSw2QkFBQWUsT0FBTyxHQUFLLGtDQUFaLGdDQUFrRGYsVUFBVSxDQUFDakQsV0FBWCxHQUEyQixpQkFBN0UsQ0FBSixDQUFvRyx1REFBRTtBQUNsR2lFLFFBQVEsQ0FBQzlCLElBQVQsQ0FBY2MsVUFBZCxFQUNILENBRkQsSUFHSywwREFBSSw2QkFBQWUsT0FBTyxHQUFLLHlCQUFaLElBQTBDLDZCQUFBZixVQUFVLENBQUNqRCxXQUFYLEdBQTJCLFlBQTNCLGdDQUEyQ2lELFVBQVUsQ0FBQ2pELFdBQVgsR0FBMkIsV0FBdEUsQ0FBMUMsQ0FBSixDQUFrSSx1REFDbklpRSxRQUFRLENBQUM5QixJQUFULENBQWNjLFVBQWQsRUFDSCxDQUZJLGtDQUVKLENBQ0osQ0FQRCxFQUxvQywwQkFjcENZLGFBQWEsQ0FBQ0MsVUFBZCxDQUF5QnBFLEtBQXpCLENBQWlDdUUsUUFBakMsQ0FFQTtBQWhCb0MsMEJBaUJwQyxNQUFPLENBQUMsQ0FBQ0EsUUFBUSxDQUFDQyxNQUFsQixDQUNILENBbEJELElBa0JPLHVEQUNILEtBQU1MLENBQUFBLGFBQWEsQ0FBQzFELE9BQWQsQ0FBc0JDLFlBQXRCLENBQW1DLDBCQUFuQyxDQUFOLENBRUE7QUFIRywwQkFJSCxNQUFPLEtBQVAsQ0FDSCxDQUNKLENBelBvQyxDLDBCQTZQekMrRCxNQUFNLENBQUNDLE9BQVAsQ0FBZTFHLFVBQWYsQ0FBNEJBLFVBQTVCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuXHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcbmNvbnN0IGF4aW9zID0gcmVxdWlyZSgnYXhpb3MnKTtcclxuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xyXG5jb25zdCBmc2UgPSByZXF1aXJlKFwiZnMtZXh0cmFcIik7XHJcbnZhciBGb3JtRGF0YSA9IHJlcXVpcmUoXCJmb3JtLWRhdGFcIik7XHJcbmNvbnN0IHtcclxuICAgIEF0dGFjaG1lbnRQcm9tcHQsXHJcbiAgICBDaG9pY2VGYWN0b3J5LFxyXG4gICAgQ2hvaWNlUHJvbXB0LFxyXG4gICAgQ29tcG9uZW50RGlhbG9nLFxyXG4gICAgQ29uZmlybVByb21wdCxcclxuICAgIERpYWxvZ1NldCxcclxuICAgIERpYWxvZ1R1cm5TdGF0dXMsXHJcbiAgICBUZXh0UHJvbXB0LFxyXG4gICAgV2F0ZXJmYWxsRGlhbG9nXHJcbn0gPSByZXF1aXJlKCdib3RidWlsZGVyLWRpYWxvZ3MnKTtcclxuY29uc3QgeyBBbnN3ZXJEaWFsb2csIEFOU1dFUl9ESUFMT0cgfSA9IHJlcXVpcmUoJy4vYW5zd2VyRGlhbG9nJyk7XHJcbmNvbnN0IHsgRG9jRGlhbG9nLCBET0NfRElBTE9HIH0gPSByZXF1aXJlKCcuL2RvY0RpYWxvZycpO1xyXG5cclxuY29uc3QgQVRUQUNITUVOVF9QUk9NUFQgPSAnQVRUQUNITUVOVF9QUk9NUFQnO1xyXG5jb25zdCBDSE9JQ0VfUFJPTVBUID0gJ0NIT0lDRV9QUk9NUFQnO1xyXG5jb25zdCBDT05GSVJNX1BST01QVCA9ICdDT05GSVJNX1BST01QVCc7XHJcbmNvbnN0IFdBVEVSRkFMTF9ESUFMT0cgPSAnV0FURVJGQUxMX0RJQUxPRyc7XHJcblxyXG5jbGFzcyBNYWluRGlhbG9nIGV4dGVuZHMgQ29tcG9uZW50RGlhbG9nIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCdtYWluRGlhbG9nJyk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBBbnN3ZXJEaWFsb2coKSk7XHJcbiAgICAgICAgdGhpcy5hZGREaWFsb2cobmV3IERvY0RpYWxvZyh0aGlzLmluaXRpYWxEaWFsb2dJZCkpO1xyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBUZXh0UHJvbXB0KCdUZXh0UHJvbXB0JykpO1xyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBDaG9pY2VQcm9tcHQoQ0hPSUNFX1BST01QVCkpO1xyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBDb25maXJtUHJvbXB0KENPTkZJUk1fUFJPTVBUKSk7XHJcbiAgICAgICAgdGhpcy5hZGREaWFsb2cobmV3IEF0dGFjaG1lbnRQcm9tcHQoQVRUQUNITUVOVF9QUk9NUFQsIHRoaXMucHJvbXB0VmFsaWRhdG9yKSk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBXYXRlcmZhbGxEaWFsb2coV0FURVJGQUxMX0RJQUxPRywgW1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0U3RlcC5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICB0aGlzLmNob29zZVN0ZXAuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgdGhpcy5kb2NTdGVwLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIHRoaXMucmVwZWF0U3RlcC5iaW5kKHRoaXMpXHJcbiAgICAgICAgXSkpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRpYWxEaWFsb2dJZCA9IFdBVEVSRkFMTF9ESUFMT0c7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcnVuIG1ldGhvZCBoYW5kbGVzIHRoZSBpbmNvbWluZyBhY3Rpdml0eSAoaW4gdGhlIGZvcm0gb2YgYSBUdXJuQ29udGV4dCkgYW5kIHBhc3NlcyBpdCB0aHJvdWdoIHRoZSBkaWFsb2cgc3lzdGVtLlxyXG4gICAgICogSWYgbm8gZGlhbG9nIGlzIGFjdGl2ZSwgaXQgd2lsbCBzdGFydCB0aGUgZGVmYXVsdCBkaWFsb2cuXHJcbiAgICAgKiBAcGFyYW0geyp9IHR1cm5Db250ZXh0XHJcbiAgICAgKiBAcGFyYW0geyp9IGFjY2Vzc29yXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHJ1bih0dXJuQ29udGV4dCwgYWNjZXNzb3IpIHtcclxuICAgICAgICBjb25zdCBkaWFsb2dTZXQgPSBuZXcgRGlhbG9nU2V0KGFjY2Vzc29yKTtcclxuICAgICAgICBkaWFsb2dTZXQuYWRkKHRoaXMpO1xyXG5cclxuICAgICAgICBjb25zdCBkaWFsb2dDb250ZXh0ID0gYXdhaXQgZGlhbG9nU2V0LmNyZWF0ZUNvbnRleHQodHVybkNvbnRleHQpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBkaWFsb2dDb250ZXh0LmNvbnRpbnVlRGlhbG9nKCk7XHJcbiAgICAgICAgaWYgKHJlc3VsdHMuc3RhdHVzID09PSBEaWFsb2dUdXJuU3RhdHVzLmVtcHR5KSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGRpYWxvZ0NvbnRleHQuYmVnaW5EaWFsb2codGhpcy5pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHN0YXJ0U3RlcChzdGVwKSB7XHJcbiAgICAgICAgLy8gV2F0ZXJmYWxsU3RlcCBhbHdheXMgZmluaXNoZXMgd2l0aCB0aGUgZW5kIG9mIHRoZSBXYXRlcmZhbGwgb3Igd2l0aCBhbm90aGVyIGRpYWxvZzsgaGVyZSBpdCBpcyBhIFByb21wdCBEaWFsb2cuXHJcbiAgICAgICAgLy8gUnVubmluZyBhIHByb21wdCBoZXJlIG1lYW5zIHRoZSBuZXh0IFdhdGVyZmFsbFN0ZXAgd2lsbCBiZSBydW4gd2hlbiB0aGUgdXNlcidzIHJlc3BvbnNlIGlzIHJlY2VpdmVkLlxyXG4gICAgICAgIGNvbnN0IG1zZyA9IHN0ZXAub3B0aW9ucy5yZXN0YXJ0TXNnID8gc3RlcC5vcHRpb25zLnJlc3RhcnRNc2cgOiAnV2hhdCBjYW4gSSBkbyBmb3IgeW91Pyc7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHN0ZXAucHJvbXB0KENIT0lDRV9QUk9NUFQsIHtcclxuICAgICAgICAgICAgcHJvbXB0OiBtc2csXHJcbiAgICAgICAgICAgIGNob2ljZXM6IENob2ljZUZhY3RvcnkudG9DaG9pY2VzKFsnYXNrIGEgcXVlc3Rpb24nLCAncHJvY2VzcyBhIGRvY3VtZW50JywgLCAncmVjb2duaXplIGFuIGltYWdlJ10pXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY2hvb3NlU3RlcChzdGVwKSB7XHJcbiAgICAgICAgY29uc3QgY2hvaWNlID0gc3RlcC5yZXN1bHQudmFsdWU7XHJcbiAgICAgICAgaWYgKGNob2ljZSA9PSAnYXNrIGEgcXVlc3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBzdGVwLmJlZ2luRGlhbG9nKEFOU1dFUl9ESUFMT0cpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaG9pY2UgPT0gJ3Byb2Nlc3MgYSBkb2N1bWVudCcpIHtcclxuICAgICAgICAgICAgdmFyIHByb21wdE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICBwcm9tcHQ6ICdQbGVhc2UgYXR0YWNoIGEgZG9jdW1lbnQgaW4gcGRmLicsXHJcbiAgICAgICAgICAgICAgICByZXRyeVByb21wdDogJ1RoYXQgd2FzIG5vdCBhIGRvY3VtZW50IHRoYXQgSSBjYW4gaGVscCwgcGxlYXNlIHRyeSBhZ2Fpbi4nXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgc3RlcC5wcm9tcHQoQVRUQUNITUVOVF9QUk9NUFQsIHByb21wdE9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHByb21wdE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICBwcm9tcHQ6ICdQbGVhc2UgYXR0YWNoIGFuIGltYWdlLicsXHJcbiAgICAgICAgICAgICAgICByZXRyeVByb21wdDogJ1RoYXQgd2FzIG5vdCBhbiBpbWFnZSB0aGF0IEkgY2FuIGhlbHAsIHBsZWFzZSB0cnkgYWdhaW4uJ1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHN0ZXAucHJvbXB0KEFUVEFDSE1FTlRfUFJPTVBULCBwcm9tcHRPcHRpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGRvY1N0ZXAoc3RlcCkge1xyXG4gICAgICAgIGlmIChzdGVwLnJlc3VsdCAmJiBzdGVwLnJlc3VsdFswXS5jb250ZW50VXJsKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0ZXAucmVzdWx0WzBdLmNvbnRlbnRUeXBlKTtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSBzdGVwLnJlc3VsdFswXS5jb250ZW50VHlwZTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdhcHBsaWNhdGlvbi9wZGYnKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGF3YWl0IHRoaXMuaGFuZGxlSW5jb21pbmdBdHRhY2htZW50KHN0ZXAuY29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncGF0aDogJyArIHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eSgnUHJvY2Vzc2luZyB0aGUgZG9jdW1lbnQsIHBsZWFzZSB3YWl0Jyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxX3Jlc3VsdHMgPSBhd2FpdCB0aGlzLnNlbmRSZXEocGF0aCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgc3RlcC5iZWdpbkRpYWxvZyhET0NfRElBTE9HLCB7IHN1bTogcmVxX3Jlc3VsdHNbMF0sIHF1ZXJ5OiByZXFfcmVzdWx0c1sxXSwgZm9ybTogcmVxX3Jlc3VsdHNbMl0sIGZpbGVwYXRoOiBwYXRoIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGltYWdlX3Jlc3VsdCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSBhd2FpdCB0aGlzLmhhbmRsZUluY29taW5nQXR0YWNobWVudChzdGVwLmNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eSgnUHJvY2Vzc2luZyB0aGUgaW1hZ2UsIHBsZWFzZSB3YWl0Jyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmQoXCJmaWxlXCIsIGZzZS5jcmVhdGVSZWFkU3RyZWFtKHBhdGgpKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGF4aW9zKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJ2h0dHA6Ly9hdmFib3Rmb3JtcmVjb2cuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL0Zvcm1SZWNvZ0Z1bmN0aW9uP3R5cGU9QnVzaW5lc3NDYXJkJyxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmb3JtLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGZvcm0uZ2V0SGVhZGVycygpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuZm9yRWFjaChsaW5lID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlX3Jlc3VsdCArPSBsaW5lICsgJ1xcbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW1hZ2VfcmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eShpbWFnZV9yZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eSgnSW1hZ2UgcmVjb2duaXRpb24gZmFpbGVkJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhd2FpdCBzdGVwLm5leHQoKVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBhc3luYyByZXBlYXRTdGVwKHN0ZXApIHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgc3RlcC5yZXBsYWNlRGlhbG9nKHRoaXMuaW5pdGlhbERpYWxvZ0lkLCB7IHJlc3RhcnRNc2c6ICdXaGF0IGVsc2UgY2FuIEkgZG8gZm9yIHlvdT8nIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHNlbmRSZXEocGF0aCkge1xyXG4gICAgICAgIHZhciBmb3JtMSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZvcm0xLmFwcGVuZChcImZpbGVcIiwgZnNlLmNyZWF0ZVJlYWRTdHJlYW0ocGF0aCkpO1xyXG4gICAgICAgIHZhciBmb3JtMiA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZvcm0yLmFwcGVuZChcImZpbGVcIiwgZnNlLmNyZWF0ZVJlYWRTdHJlYW0ocGF0aCkpO1xyXG4gICAgICAgIHZhciBmb3JtMyA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZvcm0zLmFwcGVuZChcImZpbGVcIiwgZnNlLmNyZWF0ZVJlYWRTdHJlYW0ocGF0aCkpO1xyXG5cclxuICAgICAgICBsZXQgcmVxQXJyID0gW2F4aW9zKHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vdGV4dHN1bWFwaS5henVyZXdlYnNpdGVzLm5ldC9hcGkvVGV4dFN1bW1hcnlcIixcclxuICAgICAgICAgICAgZGF0YTogZm9ybTEsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IGZvcm0xLmdldEhlYWRlcnMoKVxyXG4gICAgICAgIH0pLCBheGlvcyh7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgICAgIHVybDogXCJodHRwOi8vNTEuMTEuMTgyLjU6NTAwMFwiLFxyXG4gICAgICAgICAgICBkYXRhOiBmb3JtMixcclxuICAgICAgICAgICAgaGVhZGVyczogZm9ybTIuZ2V0SGVhZGVycygpXHJcbiAgICAgICAgfSksIGF4aW9zKHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vYXZhYm90Zm9ybXJlY29nLmF6dXJld2Vic2l0ZXMubmV0L2FwaS9Gb3JtUmVjb2dGdW5jdGlvbj90eXBlPUxheW91dFwiLFxyXG4gICAgICAgICAgICBkYXRhOiBmb3JtMyxcclxuICAgICAgICAgICAgaGVhZGVyczogZm9ybTMuZ2V0SGVhZGVycygpXHJcbiAgICAgICAgfSldO1xyXG4gICAgICAgIHZhciBvdXRwdXQgPSBbXTtcclxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQocmVxQXJyKS50aGVuKHJlc3VsdHMgPT4ge1xyXG4gICAgICAgICAgICByZXN1bHRzLmZvckVhY2gocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdC5zdGF0dXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT0gJ2Z1bGZpbGxlZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChyZXN1bHQudmFsdWUuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZpcnN0OiAnICsgcmVzdWx0LnZhbHVlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaCgwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5a6M5oiQ5ZWm77yBXCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKG91dHB1dCk7XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBoYW5kbGVJbmNvbWluZ0F0dGFjaG1lbnQodHVybkNvbnRleHQpIHtcclxuICAgICAgICAvLyBQcmVwYXJlIFByb21pc2VzIHRvIGRvd25sb2FkIGVhY2ggYXR0YWNobWVudCBhbmQgdGhlbiBleGVjdXRlIGVhY2ggUHJvbWlzZS5cclxuICAgICAgICBjb25zdCBwcm9taXNlcyA9IGF3YWl0IHR1cm5Db250ZXh0LmFjdGl2aXR5LmF0dGFjaG1lbnRzLm1hcCh0aGlzLmRvd25sb2FkQXR0YWNobWVudEFuZFdyaXRlKTtcclxuICAgICAgICBjb25zdCBzdWNjZXNzZnVsU2F2ZXMgPSBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XHJcblxyXG4gICAgICAgIC8vIFJlcGxpZXMgYmFjayB0byB0aGUgdXNlciB3aXRoIGluZm9ybWF0aW9uIGFib3V0IHdoZXJlIHRoZSBhdHRhY2htZW50IGlzIHN0b3JlZCBvbiB0aGUgYm90J3Mgc2VydmVyLFxyXG4gICAgICAgIC8vIGFuZCB3aGF0IHRoZSBuYW1lIG9mIHRoZSBzYXZlZCBmaWxlIGlzLlxyXG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJlcGx5Rm9yUmVjZWl2ZWRBdHRhY2htZW50cyhsb2NhbEF0dGFjaG1lbnREYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChsb2NhbEF0dGFjaG1lbnREYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBCZWNhdXNlIHRoZSBUdXJuQ29udGV4dCB3YXMgYm91bmQgdG8gdGhpcyBmdW5jdGlvbiwgdGhlIGJvdCBjYW4gY2FsbFxyXG4gICAgICAgICAgICAgICAgLy8gYFR1cm5Db250ZXh0LnNlbmRBY3Rpdml0eWAgdmlhIGB0aGlzLnNlbmRBY3Rpdml0eWA7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRBY3Rpdml0eShgQXR0YWNobWVudCBcIiR7bG9jYWxBdHRhY2htZW50RGF0YS5maWxlTmFtZX1cIiBgICtcclxuICAgICAgICAgICAgICAgICAgICBgaGFzIGJlZW4gcmVjZWl2ZWQuYCk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zZW5kQWN0aXZpdHkoJ0F0dGFjaG1lbnQgd2FzIG5vdCBzdWNjZXNzZnVsbHkgcmVjZWl2ZWQuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGxvY2FsQXR0YWNobWVudERhdGEubG9jYWxQYXRoXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBQcmVwYXJlIFByb21pc2VzIHRvIHJlcGx5IHRvIHRoZSB1c2VyIHdpdGggaW5mb3JtYXRpb24gYWJvdXQgc2F2ZWQgYXR0YWNobWVudHMuXHJcbiAgICAgICAgLy8gVGhlIGN1cnJlbnQgVHVybkNvbnRleHQgaXMgYm91bmQgc28gYHJlcGx5Rm9yUmVjZWl2ZWRBdHRhY2htZW50c2AgY2FuIGFsc28gc2VuZCByZXBsaWVzLlxyXG4gICAgICAgIGNvbnN0IHJlcGx5UHJvbWlzZXMgPSBzdWNjZXNzZnVsU2F2ZXMubWFwKHJlcGx5Rm9yUmVjZWl2ZWRBdHRhY2htZW50cy5iaW5kKHR1cm5Db250ZXh0KSk7XHJcbiAgICAgICAgbGV0IHIgPSBhd2FpdCBQcm9taXNlLmFsbChyZXBseVByb21pc2VzKS50aGVuKHJlc3VsdCA9PiByZXN1bHRbMF0pO1xyXG4gICAgICAgIHJldHVybiByXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGRvd25sb2FkQXR0YWNobWVudEFuZFdyaXRlKGF0dGFjaG1lbnQpIHtcclxuICAgICAgICB2YXIgbmFtZSA9ICd0ZXh0LicgKyBhdHRhY2htZW50LmNvbnRlbnRUeXBlLnRvU3RyaW5nKCkuc3BsaXQoJy8nKVsxXTtcclxuICAgICAgICBjb25zb2xlLmxvZyhuYW1lKTtcclxuICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgYXR0YWNobWVudCB2aWEgdGhlIGF0dGFjaG1lbnQncyBjb250ZW50VXJsLlxyXG4gICAgICAgIGNvbnN0IHVybCA9IGF0dGFjaG1lbnQuY29udGVudFVybDtcclxuXHJcbiAgICAgICAgLy8gTG9jYWwgZmlsZSBwYXRoIGZvciB0aGUgYm90IHRvIHNhdmUgdGhlIGF0dGFjaG1lbnQuXHJcbiAgICAgICAgY29uc3QgbG9jYWxGaWxlTmFtZSA9IHBhdGguam9pbihfX2Rpcm5hbWUsIG5hbWUpO1xyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBhcnJheWJ1ZmZlciBpcyBuZWNlc3NhcnkgZm9yIGltYWdlc1xyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCh1cmwsIHsgcmVzcG9uc2VUeXBlOiAnYXJyYXlidWZmZXInIH0pO1xyXG4gICAgICAgICAgICBmcy53cml0ZUZpbGUobG9jYWxGaWxlTmFtZSwgcmVzcG9uc2UuZGF0YSwgKGZzRXJyb3IpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChmc0Vycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZnNFcnJvcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIG5vIGVycm9yIHdhcyB0aHJvd24gd2hpbGUgd3JpdGluZyB0byBkaXNrLCByZXR1cm4gdGhlIGF0dGFjaG1lbnQncyBuYW1lXHJcbiAgICAgICAgLy8gYW5kIGxvY2FsRmlsZVBhdGggZm9yIHRoZSByZXNwb25zZSBiYWNrIHRvIHRoZSB1c2VyLlxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGZpbGVOYW1lOiBhdHRhY2htZW50Lm5hbWUsXHJcbiAgICAgICAgICAgIGxvY2FsUGF0aDogbG9jYWxGaWxlTmFtZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBhc3luYyBwcm9tcHRWYWxpZGF0b3IocHJvbXB0Q29udGV4dCkge1xyXG4gICAgICAgIGlmIChwcm9tcHRDb250ZXh0LnJlY29nbml6ZWQuc3VjY2VlZGVkKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2NUeXBlID0gcHJvbXB0Q29udGV4dC5vcHRpb25zLnByb21wdDtcclxuICAgICAgICAgICAgdmFyIGF0dGFjaG1lbnRzID0gcHJvbXB0Q29udGV4dC5yZWNvZ25pemVkLnZhbHVlO1xyXG4gICAgICAgICAgICB2YXIgdmFsaWREb2MgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGF0dGFjaG1lbnRzLmZvckVhY2goYXR0YWNobWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZG9jVHlwZSA9PT0gJ1BsZWFzZSBhdHRhY2ggYSBkb2N1bWVudCBpbiBwZGYuJyAmJiBhdHRhY2htZW50LmNvbnRlbnRUeXBlID09PSAnYXBwbGljYXRpb24vcGRmJykgeyAvL3x8IGF0dGFjaG1lbnQuY29udGVudFR5cGUgPT09ICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCd8fCBhdHRhY2htZW50LmNvbnRlbnRUeXBlID09PSAnYXBwbGljYXRpb24vbXN3b3JkJ1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkRG9jLnB1c2goYXR0YWNobWVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChkb2NUeXBlID09PSAnUGxlYXNlIGF0dGFjaCBhbiBpbWFnZS4nICYmIChhdHRhY2htZW50LmNvbnRlbnRUeXBlID09PSAnaW1hZ2UvanBlZycgfHwgYXR0YWNobWVudC5jb250ZW50VHlwZSA9PT0gJ2ltYWdlL3BuZycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWREb2MucHVzaChhdHRhY2htZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBwcm9tcHRDb250ZXh0LnJlY29nbml6ZWQudmFsdWUgPSB2YWxpZERvYztcclxuXHJcbiAgICAgICAgICAgIC8vIElmIG5vbmUgb2YgdGhlIGF0dGFjaG1lbnRzIGFyZSB2YWxpZCBpbWFnZXMsIHRoZSByZXRyeSBwcm9tcHQgc2hvdWxkIGJlIHNlbnQuXHJcbiAgICAgICAgICAgIHJldHVybiAhIXZhbGlkRG9jLmxlbmd0aDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhd2FpdCBwcm9tcHRDb250ZXh0LmNvbnRleHQuc2VuZEFjdGl2aXR5KCdObyBhdHRhY2htZW50cyByZWNlaXZlZC4nKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFdlIGNhbiByZXR1cm4gdHJ1ZSBmcm9tIGEgdmFsaWRhdG9yIGZ1bmN0aW9uIGV2ZW4gaWYgUmVjb2duaXplZC5TdWNjZWVkZWQgaXMgZmFsc2UuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzLk1haW5EaWFsb2cgPSBNYWluRGlhbG9nOyJdfQ==