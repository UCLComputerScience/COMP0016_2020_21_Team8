function cov_1boptpdvjn(){var path="/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/docDialog.js";var hash="cebac8431a4f497b10132401eab5f60db363f9ee";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/doudou/COMP0016_2020_21_Team8/AvabotTeam8-src/dialogs/docDialog.js",statementMap:{"0":{start:{line:4,column:86},end:{line:4,column:115}},"1":{start:{line:5,column:19},end:{line:5,column:31}},"2":{start:{line:6,column:25},end:{line:6,column:43}},"3":{start:{line:7,column:20},end:{line:7,column:33}},"4":{start:{line:8,column:22},end:{line:8,column:37}},"5":{start:{line:13,column:8},end:{line:13,column:26}},"6":{start:{line:14,column:8},end:{line:14,column:29}},"7":{start:{line:15,column:8},end:{line:15,column:22}},"8":{start:{line:16,column:8},end:{line:16,column:23}},"9":{start:{line:17,column:8},end:{line:17,column:24}},"10":{start:{line:18,column:8},end:{line:18,column:27}},"11":{start:{line:20,column:8},end:{line:20,column:52}},"12":{start:{line:21,column:8},end:{line:21,column:56}},"13":{start:{line:22,column:8},end:{line:26,column:12}},"14":{start:{line:28,column:8},end:{line:28,column:48}},"15":{start:{line:32,column:8},end:{line:47,column:9}},"16":{start:{line:33,column:12},end:{line:36,column:15}},"17":{start:{line:39,column:12},end:{line:39,column:84}},"18":{start:{line:40,column:12},end:{line:40,column:92}},"19":{start:{line:41,column:12},end:{line:41,column:88}},"20":{start:{line:42,column:12},end:{line:42,column:104}},"21":{start:{line:43,column:12},end:{line:46,column:15}},"22":{start:{line:51,column:8},end:{line:51,column:39}},"23":{start:{line:52,column:23},end:{line:52,column:40}},"24":{start:{line:53,column:8},end:{line:92,column:9}},"25":{start:{line:54,column:12},end:{line:59,column:13}},"26":{start:{line:55,column:16},end:{line:55,column:58}},"27":{start:{line:58,column:16},end:{line:58,column:73}},"28":{start:{line:62,column:13},end:{line:92,column:9}},"29":{start:{line:63,column:12},end:{line:79,column:13}},"30":{start:{line:64,column:16},end:{line:74,column:17}},"31":{start:{line:65,column:28},end:{line:65,column:30}},"32":{start:{line:66,column:20},end:{line:68,column:23}},"33":{start:{line:67,column:24},end:{line:67,column:34}},"34":{start:{line:69,column:20},end:{line:69,column:35}},"35":{start:{line:70,column:20},end:{line:70,column:55}},"36":{start:{line:73,column:20},end:{line:73,column:63}},"37":{start:{line:78,column:16},end:{line:78,column:76}},"38":{start:{line:81,column:13},end:{line:92,column:9}},"39":{start:{line:82,column:12},end:{line:87,column:13}},"40":{start:{line:83,column:16},end:{line:83,column:91}},"41":{start:{line:86,column:16},end:{line:86,column:83}},"42":{start:{line:91,column:12},end:{line:91,column:42}},"43":{start:{line:94,column:8},end:{line:94,column:109}},"44":{start:{line:106,column:8},end:{line:106,column:76}},"45":{start:{line:107,column:8},end:{line:107,column:109}},"46":{start:{line:126,column:8},end:{line:126,column:21}},"47":{start:{line:129,column:8},end:{line:129,column:23}},"48":{start:{line:132,column:8},end:{line:132,column:22}},"49":{start:{line:136,column:0},end:{line:136,column:37}},"50":{start:{line:137,column:0},end:{line:137,column:39}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:4},end:{line:12,column:5}},loc:{start:{line:12,column:24},end:{line:29,column:5}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:31,column:4},end:{line:31,column:5}},loc:{start:{line:31,column:33},end:{line:48,column:5}},line:31},"2":{name:"(anonymous_2)",decl:{start:{line:50,column:4},end:{line:50,column:5}},loc:{start:{line:50,column:25},end:{line:95,column:5}},line:50},"3":{name:"(anonymous_3)",decl:{start:{line:66,column:38},end:{line:66,column:39}},loc:{start:{line:66,column:46},end:{line:68,column:21}},line:66},"4":{name:"(anonymous_4)",decl:{start:{line:97,column:4},end:{line:97,column:5}},loc:{start:{line:97,column:27},end:{line:108,column:5}},line:97},"5":{name:"(anonymous_5)",decl:{start:{line:125,column:4},end:{line:125,column:5}},loc:{start:{line:125,column:13},end:{line:127,column:5}},line:125},"6":{name:"(anonymous_6)",decl:{start:{line:128,column:4},end:{line:128,column:5}},loc:{start:{line:128,column:13},end:{line:130,column:5}},line:128},"7":{name:"(anonymous_7)",decl:{start:{line:131,column:4},end:{line:131,column:5}},loc:{start:{line:131,column:13},end:{line:133,column:5}},line:131}},branchMap:{"0":{loc:{start:{line:32,column:8},end:{line:47,column:9}},type:"if",locations:[{start:{line:32,column:8},end:{line:47,column:9}},{start:{line:32,column:8},end:{line:47,column:9}}],line:32},"1":{loc:{start:{line:39,column:23},end:{line:39,column:83}},type:"cond-expr",locations:[{start:{line:39,column:49},end:{line:39,column:72}},{start:{line:39,column:75},end:{line:39,column:83}}],line:39},"2":{loc:{start:{line:40,column:25},end:{line:40,column:91}},type:"cond-expr",locations:[{start:{line:40,column:53},end:{line:40,column:78}},{start:{line:40,column:81},end:{line:40,column:91}}],line:40},"3":{loc:{start:{line:41,column:24},end:{line:41,column:87}},type:"cond-expr",locations:[{start:{line:41,column:51},end:{line:41,column:75}},{start:{line:41,column:78},end:{line:41,column:87}}],line:41},"4":{loc:{start:{line:42,column:28},end:{line:42,column:103}},type:"cond-expr",locations:[{start:{line:42,column:59},end:{line:42,column:87}},{start:{line:42,column:90},end:{line:42,column:103}}],line:42},"5":{loc:{start:{line:53,column:8},end:{line:92,column:9}},type:"if",locations:[{start:{line:53,column:8},end:{line:92,column:9}},{start:{line:53,column:8},end:{line:92,column:9}}],line:53},"6":{loc:{start:{line:54,column:12},end:{line:59,column:13}},type:"if",locations:[{start:{line:54,column:12},end:{line:59,column:13}},{start:{line:54,column:12},end:{line:59,column:13}}],line:54},"7":{loc:{start:{line:62,column:13},end:{line:92,column:9}},type:"if",locations:[{start:{line:62,column:13},end:{line:92,column:9}},{start:{line:62,column:13},end:{line:92,column:9}}],line:62},"8":{loc:{start:{line:63,column:12},end:{line:79,column:13}},type:"if",locations:[{start:{line:63,column:12},end:{line:79,column:13}},{start:{line:63,column:12},end:{line:79,column:13}}],line:63},"9":{loc:{start:{line:64,column:16},end:{line:74,column:17}},type:"if",locations:[{start:{line:64,column:16},end:{line:74,column:17}},{start:{line:64,column:16},end:{line:74,column:17}}],line:64},"10":{loc:{start:{line:81,column:13},end:{line:92,column:9}},type:"if",locations:[{start:{line:81,column:13},end:{line:92,column:9}},{start:{line:81,column:13},end:{line:92,column:9}}],line:81},"11":{loc:{start:{line:82,column:12},end:{line:87,column:13}},type:"if",locations:[{start:{line:82,column:12},end:{line:87,column:13}},{start:{line:82,column:12},end:{line:87,column:13}}],line:82}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cebac8431a4f497b10132401eab5f60db363f9ee"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1boptpdvjn=function(){return actualCoverage;};}return actualCoverage;}cov_1boptpdvjn();// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
const{ComponentDialog,ChoiceFactory,ChoicePrompt,TextPrompt,WaterfallDialog}=(cov_1boptpdvjn().s[0]++,require('botbuilder-dialogs'));const DOC_DIALOG=(cov_1boptpdvjn().s[1]++,'DOC_DIALOG');const WATERFALL_DIALOG=(cov_1boptpdvjn().s[2]++,'WATERFALL_DIALOG');const TEXT_PROMPT=(cov_1boptpdvjn().s[3]++,'TEXT_PROMPT');const CHOICE_PROMPT=(cov_1boptpdvjn().s[4]++,'CHOICE_PROMPT');class DocDialog extends ComponentDialog{constructor(mainId){cov_1boptpdvjn().f[0]++;cov_1boptpdvjn().s[5]++;super(DOC_DIALOG);cov_1boptpdvjn().s[6]++;this.mainId=mainId;cov_1boptpdvjn().s[7]++;this.sum='';cov_1boptpdvjn().s[8]++;this.form='';cov_1boptpdvjn().s[9]++;this.query='';cov_1boptpdvjn().s[10]++;this.filepath='';cov_1boptpdvjn().s[11]++;this.addDialog(new TextPrompt(TEXT_PROMPT));cov_1boptpdvjn().s[12]++;this.addDialog(new ChoicePrompt(CHOICE_PROMPT));cov_1boptpdvjn().s[13]++;this.addDialog(new WaterfallDialog(WATERFALL_DIALOG,[this.beginStep.bind(this),this.dealStep.bind(this),this.answerStep.bind(this)]));cov_1boptpdvjn().s[14]++;this.initialDialogId=WATERFALL_DIALOG;}async beginStep(stepContext){cov_1boptpdvjn().f[1]++;cov_1boptpdvjn().s[15]++;if(stepContext.options.restartMsg){cov_1boptpdvjn().b[0][0]++;cov_1boptpdvjn().s[16]++;return await stepContext.prompt(CHOICE_PROMPT,{prompt:'Anything else for the document?',choices:ChoiceFactory.toChoices(['summarize it','extract table','QnA about it','no'])});}else{cov_1boptpdvjn().b[0][1]++;cov_1boptpdvjn().s[17]++;this.sum=stepContext.options.sum?(cov_1boptpdvjn().b[1][0]++,stepContext.options.sum):(cov_1boptpdvjn().b[1][1]++,this.sum);cov_1boptpdvjn().s[18]++;this.query=stepContext.options.query?(cov_1boptpdvjn().b[2][0]++,stepContext.options.query):(cov_1boptpdvjn().b[2][1]++,this.query);cov_1boptpdvjn().s[19]++;this.form=stepContext.options.form?(cov_1boptpdvjn().b[3][0]++,stepContext.options.form):(cov_1boptpdvjn().b[3][1]++,this.form);cov_1boptpdvjn().s[20]++;this.filepath=stepContext.options.filepath?(cov_1boptpdvjn().b[4][0]++,stepContext.options.filepath):(cov_1boptpdvjn().b[4][1]++,this.filepath);cov_1boptpdvjn().s[21]++;return await stepContext.prompt(CHOICE_PROMPT,{prompt:'How can I help with the document?',choices:ChoiceFactory.toChoices(['summarize it','extract table','QnA about it'])});}}async dealStep(step){cov_1boptpdvjn().f[2]++;cov_1boptpdvjn().s[22]++;console.log(step.result.value);const choice=(cov_1boptpdvjn().s[23]++,step.result.value);cov_1boptpdvjn().s[24]++;if(choice=='summarize it'){cov_1boptpdvjn().b[5][0]++;cov_1boptpdvjn().s[25]++;if(this.sum){cov_1boptpdvjn().b[6][0]++;cov_1boptpdvjn().s[26]++;await step.context.sendActivity(this.sum);}else{cov_1boptpdvjn().b[6][1]++;cov_1boptpdvjn().s[27]++;await step.context.sendActivity('Summarization failed.');}}else{cov_1boptpdvjn().b[5][1]++;cov_1boptpdvjn().s[28]++;if(choice=='extract table'){cov_1boptpdvjn().b[7][0]++;cov_1boptpdvjn().s[29]++;if(this.form){cov_1boptpdvjn().b[8][0]++;cov_1boptpdvjn().s[30]++;if(this.form!='No Table Found'){cov_1boptpdvjn().b[9][0]++;var b=(cov_1boptpdvjn().s[31]++,'');cov_1boptpdvjn().s[32]++;this.form.forEach(line=>{cov_1boptpdvjn().f[3]++;cov_1boptpdvjn().s[33]++;b+=line;});cov_1boptpdvjn().s[34]++;console.log(b);cov_1boptpdvjn().s[35]++;await step.context.sendActivity(b);}else{cov_1boptpdvjn().b[9][1]++;cov_1boptpdvjn().s[36]++;await step.context.sendActivity(this.form);}}else{cov_1boptpdvjn().b[8][1]++;cov_1boptpdvjn().s[37]++;await step.context.sendActivity('Form recognition failed.');}}else{cov_1boptpdvjn().b[7][1]++;cov_1boptpdvjn().s[38]++;if(choice=='QnA about it'){cov_1boptpdvjn().b[10][0]++;cov_1boptpdvjn().s[39]++;if(this.query){cov_1boptpdvjn().b[11][0]++;cov_1boptpdvjn().s[40]++;return await step.prompt(TEXT_PROMPT,{prompt:'What is the question?'});}else{cov_1boptpdvjn().b[11][1]++;cov_1boptpdvjn().s[41]++;await step.context.sendActivity('QA system preprocessing failed.');}}else{cov_1boptpdvjn().b[10][1]++;cov_1boptpdvjn().s[42]++;return await step.endDialog();}}}cov_1boptpdvjn().s[43]++;return await step.replaceDialog(this.initialDialogId,{restartMsg:'What else can I do for you?'});}async answerStep(step){cov_1boptpdvjn().f[4]++;cov_1boptpdvjn().s[44]++;// var question = step.result;
// console.log('question: ' + question);
// let answer = await axios.get('http://51.11.38.199:5000?query="'+question)
// .then(v => v.data)
// .catch(function (error) {
//     console.log(error);
// });
// await step.context.sendActivity(answer);
await step.context.sendActivity('More functions to be updating...');cov_1boptpdvjn().s[45]++;return await step.replaceDialog(this.initialDialogId,{restartMsg:'What else can I do for you?'});}// async sumText(step) {
//     var form = new FormData();
//     const FileName = path.join(__dirname, 'text.pdf');
//     form.append("file", fse.createReadStream(FileName));
//     let r = await axios({
//         method: "post",
//         url: "https://textsumapi.azurewebsites.net/api/textsumapi",
//         data: form,
//         headers: form.getHeaders()
//     }).then(v => v.data);
//     console.log(r); // ok
//     await step.context.sendActivity(r);
// }
set a(n){cov_1boptpdvjn().f[5]++;cov_1boptpdvjn().s[46]++;this.sum=n;}set b(n){cov_1boptpdvjn().f[6]++;cov_1boptpdvjn().s[47]++;this.query=n;}set c(n){cov_1boptpdvjn().f[7]++;cov_1boptpdvjn().s[48]++;this.form=n;}}cov_1boptpdvjn().s[49]++;module.exports.DocDialog=DocDialog;cov_1boptpdvjn().s[50]++;module.exports.DOC_DIALOG=DOC_DIALOG;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRvY0RpYWxvZy5qcyJdLCJuYW1lcyI6WyJDb21wb25lbnREaWFsb2ciLCJDaG9pY2VGYWN0b3J5IiwiQ2hvaWNlUHJvbXB0IiwiVGV4dFByb21wdCIsIldhdGVyZmFsbERpYWxvZyIsInJlcXVpcmUiLCJET0NfRElBTE9HIiwiV0FURVJGQUxMX0RJQUxPRyIsIlRFWFRfUFJPTVBUIiwiQ0hPSUNFX1BST01QVCIsIkRvY0RpYWxvZyIsImNvbnN0cnVjdG9yIiwibWFpbklkIiwic3VtIiwiZm9ybSIsInF1ZXJ5IiwiZmlsZXBhdGgiLCJhZGREaWFsb2ciLCJiZWdpblN0ZXAiLCJiaW5kIiwiZGVhbFN0ZXAiLCJhbnN3ZXJTdGVwIiwiaW5pdGlhbERpYWxvZ0lkIiwic3RlcENvbnRleHQiLCJvcHRpb25zIiwicmVzdGFydE1zZyIsInByb21wdCIsImNob2ljZXMiLCJ0b0Nob2ljZXMiLCJzdGVwIiwiY29uc29sZSIsImxvZyIsInJlc3VsdCIsInZhbHVlIiwiY2hvaWNlIiwiY29udGV4dCIsInNlbmRBY3Rpdml0eSIsImIiLCJmb3JFYWNoIiwibGluZSIsImVuZERpYWxvZyIsInJlcGxhY2VEaWFsb2ciLCJhIiwibiIsImMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiMDVPQWVZOzJGQWZaO0FBQ0E7QUFFQSxLQUFNLENBQUVBLGVBQUYsQ0FBbUJDLGFBQW5CLENBQWtDQyxZQUFsQyxDQUFnREMsVUFBaEQsQ0FBNERDLGVBQTVELDJCQUFnRkMsT0FBTyxDQUFDLG9CQUFELENBQXZGLENBQU4sQ0FDQSxLQUFNQyxDQUFBQSxVQUFVLDBCQUFHLFlBQUgsQ0FBaEIsQ0FDQSxLQUFNQyxDQUFBQSxnQkFBZ0IsMEJBQUcsa0JBQUgsQ0FBdEIsQ0FDQSxLQUFNQyxDQUFBQSxXQUFXLDBCQUFHLGFBQUgsQ0FBakIsQ0FDQSxLQUFNQyxDQUFBQSxhQUFhLDBCQUFHLGVBQUgsQ0FBbkIsQ0FHQSxLQUFNQyxDQUFBQSxTQUFOLFFBQXdCVixDQUFBQSxlQUFn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dGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG5cclxuY29uc3QgeyBDb21wb25lbnREaWFsb2csIENob2ljZUZhY3RvcnksIENob2ljZVByb21wdCwgVGV4dFByb21wdCwgV2F0ZXJmYWxsRGlhbG9nIH0gPSByZXF1aXJlKCdib3RidWlsZGVyLWRpYWxvZ3MnKTtcclxuY29uc3QgRE9DX0RJQUxPRyA9ICdET0NfRElBTE9HJztcclxuY29uc3QgV0FURVJGQUxMX0RJQUxPRyA9ICdXQVRFUkZBTExfRElBTE9HJztcclxuY29uc3QgVEVYVF9QUk9NUFQgPSAnVEVYVF9QUk9NUFQnO1xyXG5jb25zdCBDSE9JQ0VfUFJPTVBUID0gJ0NIT0lDRV9QUk9NUFQnO1xyXG5cclxuXHJcbmNsYXNzIERvY0RpYWxvZyBleHRlbmRzIENvbXBvbmVudERpYWxvZyB7XHJcbiAgICBjb25zdHJ1Y3RvcihtYWluSWQpIHtcclxuICAgICAgICBzdXBlcihET0NfRElBTE9HKTtcclxuICAgICAgICB0aGlzLm1haW5JZCA9IG1haW5JZDtcclxuICAgICAgICB0aGlzLnN1bSA9ICcnO1xyXG4gICAgICAgIHRoaXMuZm9ybSA9ICcnO1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSAnJztcclxuICAgICAgICB0aGlzLmZpbGVwYXRoID0gJyc7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkRGlhbG9nKG5ldyBUZXh0UHJvbXB0KFRFWFRfUFJPTVBUKSk7XHJcbiAgICAgICAgdGhpcy5hZGREaWFsb2cobmV3IENob2ljZVByb21wdChDSE9JQ0VfUFJPTVBUKSk7XHJcbiAgICAgICAgdGhpcy5hZGREaWFsb2cobmV3IFdhdGVyZmFsbERpYWxvZyhXQVRFUkZBTExfRElBTE9HLCBbXHJcbiAgICAgICAgICAgIHRoaXMuYmVnaW5TdGVwLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIHRoaXMuZGVhbFN0ZXAuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgdGhpcy5hbnN3ZXJTdGVwLmJpbmQodGhpcylcclxuICAgICAgICBdKSk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdGlhbERpYWxvZ0lkID0gV0FURVJGQUxMX0RJQUxPRztcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBiZWdpblN0ZXAoc3RlcENvbnRleHQpIHtcclxuICAgICAgICBpZiAoc3RlcENvbnRleHQub3B0aW9ucy5yZXN0YXJ0TXNnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBzdGVwQ29udGV4dC5wcm9tcHQoQ0hPSUNFX1BST01QVCwge1xyXG4gICAgICAgICAgICAgICAgcHJvbXB0OiAnQW55dGhpbmcgZWxzZSBmb3IgdGhlIGRvY3VtZW50PycsXHJcbiAgICAgICAgICAgICAgICBjaG9pY2VzOiBDaG9pY2VGYWN0b3J5LnRvQ2hvaWNlcyhbJ3N1bW1hcml6ZSBpdCcsICdleHRyYWN0IHRhYmxlJywgJ1FuQSBhYm91dCBpdCcsICdubyddKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VtID0gc3RlcENvbnRleHQub3B0aW9ucy5zdW0gPyBzdGVwQ29udGV4dC5vcHRpb25zLnN1bSA6IHRoaXMuc3VtO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5ID0gc3RlcENvbnRleHQub3B0aW9ucy5xdWVyeSA/IHN0ZXBDb250ZXh0Lm9wdGlvbnMucXVlcnkgOiB0aGlzLnF1ZXJ5O1xyXG4gICAgICAgICAgICB0aGlzLmZvcm0gPSBzdGVwQ29udGV4dC5vcHRpb25zLmZvcm0gPyBzdGVwQ29udGV4dC5vcHRpb25zLmZvcm0gOiB0aGlzLmZvcm07XHJcbiAgICAgICAgICAgIHRoaXMuZmlsZXBhdGggPSBzdGVwQ29udGV4dC5vcHRpb25zLmZpbGVwYXRoID8gc3RlcENvbnRleHQub3B0aW9ucy5maWxlcGF0aCA6IHRoaXMuZmlsZXBhdGg7XHJcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBzdGVwQ29udGV4dC5wcm9tcHQoQ0hPSUNFX1BST01QVCwge1xyXG4gICAgICAgICAgICAgICAgcHJvbXB0OiAnSG93IGNhbiBJIGhlbHAgd2l0aCB0aGUgZG9jdW1lbnQ/JyxcclxuICAgICAgICAgICAgICAgIGNob2ljZXM6IENob2ljZUZhY3RvcnkudG9DaG9pY2VzKFsnc3VtbWFyaXplIGl0JywgJ2V4dHJhY3QgdGFibGUnLCAnUW5BIGFib3V0IGl0J10pXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBkZWFsU3RlcChzdGVwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coc3RlcC5yZXN1bHQudmFsdWUpO1xyXG4gICAgICAgIGNvbnN0IGNob2ljZSA9IHN0ZXAucmVzdWx0LnZhbHVlO1xyXG4gICAgICAgIGlmIChjaG9pY2UgPT0gJ3N1bW1hcml6ZSBpdCcpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3VtKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KHRoaXMuc3VtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHN0ZXAuY29udGV4dC5zZW5kQWN0aXZpdHkoJ1N1bW1hcml6YXRpb24gZmFpbGVkLicpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaG9pY2UgPT0gJ2V4dHJhY3QgdGFibGUnKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZvcm0pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvcm0gIT0gJ05vIFRhYmxlIEZvdW5kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLmZvckVhY2gobGluZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIgKz0gbGluZTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhiKTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KGIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KHRoaXMuZm9ybSk7ICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHN0ZXAuY29udGV4dC5zZW5kQWN0aXZpdHkoJ0Zvcm0gcmVjb2duaXRpb24gZmFpbGVkLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNob2ljZSA9PSAnUW5BIGFib3V0IGl0Jykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5xdWVyeSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHN0ZXAucHJvbXB0KFRFWFRfUFJPTVBULCB7IHByb21wdDogJ1doYXQgaXMgdGhlIHF1ZXN0aW9uPycgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzdGVwLmNvbnRleHQuc2VuZEFjdGl2aXR5KCdRQSBzeXN0ZW0gcHJlcHJvY2Vzc2luZyBmYWlsZWQuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgc3RlcC5lbmREaWFsb2coKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBhd2FpdCBzdGVwLnJlcGxhY2VEaWFsb2codGhpcy5pbml0aWFsRGlhbG9nSWQsIHsgcmVzdGFydE1zZzogJ1doYXQgZWxzZSBjYW4gSSBkbyBmb3IgeW91PycgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgYW5zd2VyU3RlcChzdGVwKSB7XHJcbiAgICAgICAgLy8gdmFyIHF1ZXN0aW9uID0gc3RlcC5yZXN1bHQ7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3F1ZXN0aW9uOiAnICsgcXVlc3Rpb24pO1xyXG4gICAgICAgIC8vIGxldCBhbnN3ZXIgPSBhd2FpdCBheGlvcy5nZXQoJ2h0dHA6Ly81MS4xMS4zOC4xOTk6NTAwMD9xdWVyeT1cIicrcXVlc3Rpb24pXHJcbiAgICAgICAgLy8gLnRoZW4odiA9PiB2LmRhdGEpXHJcbiAgICAgICAgLy8gLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgLy8gYXdhaXQgc3RlcC5jb250ZXh0LnNlbmRBY3Rpdml0eShhbnN3ZXIpO1xyXG4gICAgICAgIGF3YWl0IHN0ZXAuY29udGV4dC5zZW5kQWN0aXZpdHkoJ01vcmUgZnVuY3Rpb25zIHRvIGJlIHVwZGF0aW5nLi4uJyk7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHN0ZXAucmVwbGFjZURpYWxvZyh0aGlzLmluaXRpYWxEaWFsb2dJZCwgeyByZXN0YXJ0TXNnOiAnV2hhdCBlbHNlIGNhbiBJIGRvIGZvciB5b3U/JyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBhc3luYyBzdW1UZXh0KHN0ZXApIHtcclxuICAgIC8vICAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgLy8gICAgIGNvbnN0IEZpbGVOYW1lID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJ3RleHQucGRmJyk7XHJcbiAgICAvLyAgICAgZm9ybS5hcHBlbmQoXCJmaWxlXCIsIGZzZS5jcmVhdGVSZWFkU3RyZWFtKEZpbGVOYW1lKSk7XHJcblxyXG4gICAgLy8gICAgIGxldCByID0gYXdhaXQgYXhpb3Moe1xyXG4gICAgLy8gICAgICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgLy8gICAgICAgICB1cmw6IFwiaHR0cHM6Ly90ZXh0c3VtYXBpLmF6dXJld2Vic2l0ZXMubmV0L2FwaS90ZXh0c3VtYXBpXCIsXHJcbiAgICAvLyAgICAgICAgIGRhdGE6IGZvcm0sXHJcbiAgICAvLyAgICAgICAgIGhlYWRlcnM6IGZvcm0uZ2V0SGVhZGVycygpXHJcbiAgICAvLyAgICAgfSkudGhlbih2ID0+IHYuZGF0YSk7XHJcblxyXG4gICAgLy8gICAgIGNvbnNvbGUubG9nKHIpOyAvLyBva1xyXG4gICAgLy8gICAgIGF3YWl0IHN0ZXAuY29udGV4dC5zZW5kQWN0aXZpdHkocik7XHJcbiAgICAvLyB9XHJcbiAgICBzZXQgYShuKSB7XHJcbiAgICAgICAgdGhpcy5zdW0gPSBuO1xyXG4gICAgfVxyXG4gICAgc2V0IGIobikge1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBuO1xyXG4gICAgfVxyXG4gICAgc2V0IGMobikge1xyXG4gICAgICAgIHRoaXMuZm9ybSA9IG47XHJcbiAgICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzLkRvY0RpYWxvZyA9IERvY0RpYWxvZztcclxubW9kdWxlLmV4cG9ydHMuRE9DX0RJQUxPRyA9IERPQ19ESUFMT0c7Il19